#!/bin/bash

: "ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šé ˜åŸŸ" && {
  ##############################################################################
  #ã‚¨ãƒ‡ã‚£ã‚¿ã€ãƒ“ãƒ¥ãƒ¼ãƒ¯ãƒ¼ã®æŒ‡å®š
  ##############################################################################
  selected_editor='selected_editor'
                  #^^^^^^^^^^^^^^^ã“ã“ã«ãŠå¥½ã¿ã®ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼å‘¼ã³å‡ºã—ã‚³ãƒãƒ³ãƒ‰ã‚’è¨­å®šã—ã¦ãã ã•ã„
  selected_viewer='selected_viewer'
                  #^^^^^^^^^^^^^^^ã“ã“ã«ãŠå¥½ã¿ã®ãƒ“ãƒ¥ãƒ¼ãƒ¯ãƒ¼å‘¼ã³å‡ºã—ã‚³ãƒãƒ³ãƒ‰ã‚’è¨­å®šã—ã¦ãã ã•ã„
}

: "ãƒ˜ãƒ«ãƒ—è¡¨ç¤º" && {
  ##############################################################################
  # å¼•æ•°:ãªã—ã€ã‚‚ã—ãã¯ã‚³ãƒãƒ³ãƒ‰
  ##############################################################################
  function commandList {
    echo 'â– Simple Outliner[Wriggle Kick]'
    echo '>help'
    echo '[Wriggle Kick]ã¯ã—ã‚‡ã¼ã„ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒŠãƒ¼(æ—¥æœ¬èªç”¨)ã§ã™ã€‚'
    echo '#ã§ãƒãƒ¼ãƒ‰ã‚’ç¤ºã™æ§‹é€ åŒ–ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ã‚’å¯¾è±¡ã¨ã—ã€'
    echo 'ä»¥ä¸‹å¼•æ•°ã§ã®å‹•ä½œæŒ‡å®šã«å¾“ã„ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ã‚’è¡¨ç¤ºã—ã€æ§‹é€ ã‚’å¤‰æ›´ã—ãŸã‚Šã€ãƒãƒ¼ãƒ‰ã‚’å‰Šé™¤ã‚„è¿½åŠ ã—ãŸã‚Šã€ãƒãƒ¼ãƒ‰ã«å±æ€§ã‚’ä»˜ä¸ã—ãŸã‚Šã—ã¾ã™ã€‚'
    echo 'ç·¨é›†ã‚’æŒ‡ç¤ºã—ãŸå ´åˆã¯æŒ‡å®šã—ãŸãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã¸å¯¾è±¡ã®ãƒãƒ¼ãƒ‰ã‚’æµã—è¾¼ã‚€ã“ã¨ã§ãƒãƒ¼ãƒ‰ã‚’æŒ‡å®šã—ãŸç·¨é›†ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚'
    echo 'ç·¨é›†ã‚’åŠ ãˆã¦ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã‚’çµ‚äº†ã™ã‚‹ã¨ã€å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚‚ãã®å¤‰æ›´ã‚’é©ç”¨ã—ã¾ã™ã€‚'
    echo 'å‹•ä½œæŒ‡å®šã”ã¨ã®èª¬æ˜ã¯ã€å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã›ãšã«'
    echo 'bash wrigglekick h [command]'
    echo 'ã§ç¢ºèªã—ã¦ãã ã•ã„ã€‚'
    echo 'ã€€å¼•æ•°1:å¯¾è±¡File'
    echo 'ã€€å¼•æ•°2:å‹•ä½œæŒ‡å®š'
    echo 'ã€€ã€€ã€€ã€€ã€€t.....ãƒ„ãƒªãƒ¼ãƒ“ãƒ¥ãƒ¼(çœç•¥å¯)ã€€hã‚ªãƒ—ã‚·ãƒ§ãƒ³:ä¸å¯è¦–ãƒ•ãƒ©ã‚°onã®ãƒãƒ¼ãƒ‰ã‚’éè¡¨ç¤º'
    echo 'ã€€ã€€ã€€ã€€ã€€tl....è¡Œç•ªå·ä»˜ããƒ„ãƒªãƒ¼ãƒ“ãƒ¥ãƒ¼ã€€hã‚ªãƒ—ã‚·ãƒ§ãƒ³:ä¸å¯è¦–ãƒ•ãƒ©ã‚°onã®ãƒãƒ¼ãƒ‰ã‚’éè¡¨ç¤º'
    echo 'ã€€ã€€ã€€ã€€ã€€ta...è¡Œç•ªå·ç¯„å›²æ·±ã•ä»˜ããƒ„ãƒªãƒ¼ãƒ“ãƒ¥ãƒ¼ã€€hã‚ªãƒ—ã‚·ãƒ§ãƒ³:ä¸å¯è¦–ãƒ•ãƒ©ã‚°onã®ãƒãƒ¼ãƒ‰ã‚’éè¡¨ç¤º'
    echo 'ã€€ã€€ã€€ã€€ã€€f.....ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒ“ãƒ¥ãƒ¼ã€€hã‚ªãƒ—ã‚·ãƒ§ãƒ³:ä¸å¯è¦–ãƒ•ãƒ©ã‚°onã®ãƒãƒ¼ãƒ‰ã‚’éè¡¨ç¤º'
    echo 'ã€€ã€€ã€€ã€€ã€€fl....è¡Œç•ªå·ä»˜ããƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒ“ãƒ¥ãƒ¼ã€€hã‚ªãƒ—ã‚·ãƒ§ãƒ³:ä¸å¯è¦–ãƒ•ãƒ©ã‚°onã®ãƒãƒ¼ãƒ‰ã‚’éè¡¨ç¤º'
    echo 'ã€€ã€€ã€€ã€€ã€€fa...è¡Œç•ªå·ç¯„å›²æ·±ã•ä»˜ããƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒ“ãƒ¥ãƒ¼ã€€hã‚ªãƒ—ã‚·ãƒ§ãƒ³:ä¸å¯è¦–ãƒ•ãƒ©ã‚°onã®ãƒãƒ¼ãƒ‰ã‚’éè¡¨ç¤º'
    echo 'ã€€ã€€ã€€ã€€ã€€v.....å¯¾è±¡ãƒãƒ¼ãƒ‰ã®é–²è¦§'
    echo 'ã€€ã€€ã€€ã€€ã€€gv....å¯¾è±¡ãƒãƒ¼ãƒ‰ã®é…ä¸‹ãƒãƒ¼ãƒ‰ã‚’æ¨ªæ–­çš„ã«é–²è¦§'
    echo 'ã€€ã€€ã€€ã€€ã€€e.....å¯¾è±¡ãƒãƒ¼ãƒ‰ã®ç·¨é›†'
    echo 'ã€€ã€€ã€€ã€€ã€€d.....å¯¾è±¡ãƒãƒ¼ãƒ‰ã®å‰Šé™¤'
    echo 'ã€€ã€€ã€€ã€€ã€€gd....å¯¾è±¡ãƒãƒ¼ãƒ‰ã®å‰Šé™¤'
    echo 'ã€€ã€€ã€€ã€€ã€€h.....å¯¾è±¡ãƒãƒ¼ãƒ‰ã«ä¸å¯è¦–ãƒ•ãƒ©ã‚°ã‚’è¨­å®š(1:ä¸å¯è¦–/0:å¯è¦–)'
    echo 'ã€€ã€€ã€€ã€€ã€€gh....å¯¾è±¡ãƒãƒ¼ãƒ‰ã®é…ä¸‹ãƒãƒ¼ãƒ‰ã«ã¾ã¨ã‚ã¦ä¸å¯è¦–ãƒ•ãƒ©ã‚°ã‚’è¨­å®š(1:ä¸å¯è¦–/0:å¯è¦–)'
    echo 'ã€€ã€€ã€€ã€€ã€€i.....å¯¾è±¡ãƒãƒ¼ãƒ‰ã®ä¸‹ã«æ–°è¦ãƒãƒ¼ãƒ‰æŒ¿å…¥ã€‚è¿½åŠ å¼•æ•°ã¨ã—ã¦ãƒãƒ¼ãƒ‰å'
    echo 'ã€€ã€€ã€€ã€€ã€€ie....å¯¾è±¡ãƒãƒ¼ãƒ‰ã®ä¸‹ã«æ–°è¦ãƒãƒ¼ãƒ‰æŒ¿å…¥ã€å³ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã¸ã€‚è¿½åŠ å¼•æ•°ã¨ã—ã¦ãƒãƒ¼ãƒ‰å'
    echo 'ã€€ã€€ã€€ã€€ã€€mu....å¯¾è±¡ãƒãƒ¼ãƒ‰ã²ã¨ã¤ã‚’ä¸Šã¸ç§»å‹•'
    echo 'ã€€ã€€ã€€ã€€ã€€md....å¯¾è±¡ãƒãƒ¼ãƒ‰ã²ã¨ã¤ã‚’ä¸‹ã¸ç§»å‹•'
    echo 'ã€€ã€€ã€€ã€€ã€€ml....å¯¾è±¡ãƒãƒ¼ãƒ‰ã²ã¨ã¤ã‚’å·¦ã¸ç§»å‹•(æµ…ãã™ã‚‹)'
    echo 'ã€€ã€€ã€€ã€€ã€€mr....å¯¾è±¡ãƒãƒ¼ãƒ‰ã²ã¨ã¤ã‚’å³ã¸ç§»å‹•(æ·±ãã™ã‚‹)'
    echo 'ã€€ã€€ã€€ã€€ã€€gmu...è‡ªåˆ†ã®é…ä¸‹ãƒãƒ¼ãƒ‰ã‚’å¼•ãé€£ã‚Œã¦ä¸Šã¸ç§»å‹•'
    echo 'ã€€ã€€ã€€ã€€ã€€gmd...è‡ªåˆ†ã®é…ä¸‹ãƒãƒ¼ãƒ‰ã‚’å¼•ãé€£ã‚Œã¦ä¸‹ã¸ç§»å‹•'
    echo 'ã€€ã€€ã€€ã€€ã€€gml...è‡ªåˆ†ã®é…ä¸‹ãƒãƒ¼ãƒ‰ã‚’å¼•ãé€£ã‚Œã¦å·¦ã¸ç§»å‹•(æµ…ãã™ã‚‹)'
    echo 'ã€€ã€€ã€€ã€€ã€€gmr...è‡ªåˆ†ã®é…ä¸‹ãƒãƒ¼ãƒ‰ã‚’å¼•ãé€£ã‚Œã¦å³ã¸ç§»å‹•(æ·±ãã™ã‚‹)'
    echo 'ã€€ã€€ã€€ã€€ã€€j.....æŒ‡å®šãƒãƒ¼ãƒ‰ã‚’ã€ä¸‹ã®ãƒãƒ¼ãƒ‰ã¨çµåˆ'
    echo 'ã€€ã€€ã€€ã€€ã€€gj....è‡ªåˆ†ã®é…ä¸‹ãƒãƒ¼ãƒ‰ã‚’ã€è‡ªåˆ†ã«çµ±åˆ'
    echo 'ã€€ã€€ã€€ã€€ã€€k.....æŒ‡å®šãƒãƒ¼ãƒ‰ã®æ¸ˆ/æœªãƒãƒ¼ã‚¯ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹'
    echo 'ã€€ã€€ã€€ã€€ã€€gk....è‡ªåˆ†ã®é…ä¸‹ãƒãƒ¼ãƒ‰ã«ã¾ã¨ã‚ã¦æ¸ˆ/æœªãƒ•ãƒ©ã‚°ã‚’è¨­å®š(1:æ¸ˆ/0:æœª)'
    echo 'ã€€ã€€ã€€ã€€ã€€gc....è‡ªåˆ†ã®é…ä¸‹ãƒãƒ¼ãƒ‰ã‚’å«ã‚“ã æ–‡å­—æ•°ã‚’é€šçŸ¥ã™ã‚‹'
    echo 'ã€€ã€€ã€€ã€€ã€€s.....æŒ‡å®šãƒãƒ¼ãƒ‰ã«è¡¨ç¤ºã‚·ãƒ³ãƒœãƒ«ã‚’è¨­å®šã™ã‚‹ã€‚è¿½åŠ å¼•æ•°ã§ã‚·ãƒ³ãƒœãƒ«ã‚’æŒ‡å®š(1æ–‡å­—)'
    echo 'ã€€ã€€ã€€ã€€ã€€o.....è‡ªåˆ†ã®é…ä¸‹ãƒãƒ¼ãƒ‰ã‚’å«ã‚“ã ç¯„å›²ã‚’åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ã™ã‚‹ã€‚è¿½åŠ å¼•æ•°ã§å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«å'
    echo 'ã€€ã€€ã€€ã€€ã€€æ•°å­—...å¯¾è±¡ãƒãƒ¼ãƒ‰ã‚’ç·¨é›†(eã¨å¼•æ•°3ã‚’çœç•¥)'
    echo 'ã€€å¼•æ•°3:å‹•ä½œå¯¾è±¡ãƒãƒ¼ãƒ‰ç•ªå·/ãƒãƒ¼ãƒ‰æŒ‡å®šã®ç„¡ã„å‹•ä½œã§ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³'
    echo 'ã€€å¼•æ•°4:å‹•ä½œæŒ‡å®šã”ã¨ã«å¿…è¦ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³'
  }

  function help-t {
    clear
    echo 'â– tç³»ã‚³ãƒãƒ³ãƒ‰ ãƒ˜ãƒ«ãƒ—'
    echo 'æ›¸å¼: (bash) wrigglekick.sh [å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] t/tl/ta'
    echo ''
    echo 'tç³»ã‚³ãƒãƒ³ãƒ‰([t]ree)ã«ã¯ã€ä»–ã«tl([t]ree [l]ine)ã€ta([t]ree [a]ll)ã®ãƒ•ã‚¡ãƒŸãƒªãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚'
    echo ''
    echo 'tç³»ã‚³ãƒãƒ³ãƒ‰ãƒ•ã‚¡ãƒŸãƒªãƒ¼ã¯ã„ãšã‚Œã‚‚å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«(å®Ÿéš›ã«èµ·å‹•ã™ã‚‹éš›ã«ã¯ç¬¬1å¼•æ•°ã¨ãªã‚‹)ã®'
    echo 'ãƒ„ãƒªãƒ¼æ§‹é€ ã‚’è¡¨ç¤ºã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚ãƒ•ã‚¡ãƒŸãƒªãƒ¼å†…ã®ã‚³ãƒãƒ³ãƒ‰ã”ã¨ã«è¡¨ç¤ºã•ã‚Œã‚‹æƒ…å ±ãŒç•°ãªã‚Šã¾ã™ã€‚'
    echo ''
    echo 'hã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã£ã¦ä¸å¯è¦–å±æ€§ãŒè¨­å®šã•ã‚ŒãŸãƒãƒ¼ãƒ‰ã¯ã€æ›´ã«hã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æ¸¡ã™ã“ã¨ã§ãƒãƒ¼ãƒ‰ã‚’éè¡¨ç¤ºã«ã§ãã¾ã™ã€‚'
    echo 'fã‚³ãƒãƒ³ãƒ‰ã¨ã‚ã‚ã›ã¦ã€ç·¨é›†æ™‚ã®è¦–è¦šãƒã‚¤ã‚ºä½æ¸›ã«ã”åˆ©ç”¨ãã ã•ã„ã€‚'
    echo ''
    echo '+--------+--------+------+------+----+------+------+------+------+--------+--------+'
    echo '|ã‚³ãƒãƒ³ãƒ‰|nodeç•ªå·|é–‹å§‹è¡Œ|çµ‚äº†è¡Œ|æ·±ã•|æ–‡å­—æ•°|æ¸ˆæœªæ¸ˆ|å¯è¦–æ€§|ãƒ„ãƒªãƒ¼|å±æ€§è¨˜å·|ã‚¿ã‚¤ãƒˆãƒ«|'
    echo '+--------+--------+------+------+----+------+------+------+------+--------+--------+'
    echo '|    t   |   ï¼Š   |      |      |    |      |  ï¼Š  |      |  ï¼Š  |   ï¼Š   |   ï¼Š   |'
    echo '|   tl   |   ï¼Š   |  ï¼Š  |      |    |  ï¼Š  |  ï¼Š  |      |  ï¼Š  |   ï¼Š   |   ï¼Š   |'
    echo '|   ta   |   ï¼Š   |  ï¼Š  |  ï¼Š  | ï¼Š |  ï¼Š  |  ï¼Š  |  ï¼Š  |  ï¼Š  |   ï¼Š   |   ï¼Š   |'
    echo '+--------+--------+------+------+----+------+------+------+------+--------+--------+'
  }
  function help-f {
    clear
    echo 'â– fç³»ã‚³ãƒãƒ³ãƒ‰ ãƒ˜ãƒ«ãƒ—'
    echo 'æ›¸å¼: (bash) wrigglekick.sh [å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] f/fl/fa'
    echo ''
    echo 'fç³»ã‚³ãƒãƒ³ãƒ‰([f]orcus)ã«ã¯ã€ä»–ã«fl([f]orcus [l]ine)ã€fa([f]orcus [a]ll)ã®ãƒ•ã‚¡ãƒŸãƒªãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚'
    echo ''
    echo 'fç³»ã‚³ãƒãƒ³ãƒ‰ãƒ•ã‚¡ãƒŸãƒªãƒ¼ã¯ã„ãšã‚Œã‚‚å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«(å®Ÿéš›ã«èµ·å‹•ã™ã‚‹éš›ã«ã¯ç¬¬1å¼•æ•°ã¨ãªã‚‹)ã®'
    echo 'æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ç•ªå·ã‚’å…ˆé ­ã¨ã™ã‚‹ã‚°ãƒ«ãƒ¼ãƒ—å†…ã«çµã£ã¦ãƒ„ãƒªãƒ¼æ§‹é€ ã‚’è¡¨ç¤ºã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚'
    echo ''
    echo 'tã‚³ãƒãƒ³ãƒ‰ã¨fã‚³ãƒãƒ³ãƒ‰ã®é•ã„ã¯ã€è¡¨ç¤ºã™ã‚‹ãƒãƒ¼ãƒ‰ã‚’ã‚°ãƒ«ãƒ¼ãƒ—ã«çµã£ã¦ã„ã‚‹ã‹ã©ã†ã‹ã ã‘ã§ã™ã€‚'
    echo ''
    echo 'hã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã£ã¦ä¸å¯è¦–å±æ€§ãŒè¨­å®šã•ã‚ŒãŸãƒãƒ¼ãƒ‰ã¯ã€æ›´ã«hã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æ¸¡ã™ã“ã¨ã§ãƒãƒ¼ãƒ‰ã‚’éè¡¨ç¤ºã«ã§ãã¾ã™ã€‚'
    echo 'ç·¨é›†æ™‚ã®è¦–è¦šãƒã‚¤ã‚ºä½æ¸›ã«ã”åˆ©ç”¨ãã ã•ã„ã€‚'
    echo ''
    echo 'â€»ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã¯ã€'
    echo 'æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ã‹ã‚‰ãƒãƒ¼ãƒ‰ç•ªå·ã‚’ä¸‹ã£ã¦ã„ã'
    echo 'æœ€åˆã«ã€ŒåŸºæº–ã¨åŒã˜ã‹åŸºæº–ã‚ˆã‚Šæµ…ã„ãƒãƒ¼ãƒ‰ã€ãŒç™ºè¦‹ã•ã‚ŒãŸã¨ãã«ã€'
    echo 'æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ã€œç™ºè¦‹ã•ã‚ŒãŸãƒãƒ¼ãƒ‰ã®ä¸€ã¤æ‰‹å‰ã¾ã§ã®ç¯„å›²ã‚’æŒ‡ã—ã¾ã™ã€‚'
    echo 'æœ€å¾Œå°¾ã®ãƒãƒ¼ãƒ‰ã«åˆ°é”ã—ã¦ã‚‚åŸºæº–ã¨åŒã˜ã‹ãã‚Œã‚ˆã‚Šæµ…ã„ãƒãƒ¼ãƒ‰ãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸå ´åˆã¯'
    echo 'æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ã€œæœ€å¾Œå°¾ã®ãƒãƒ¼ãƒ‰ã‚’ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã—ã¾ã™ã€‚'
    echo ''
    echo 'ex:'
    echo '1 æ·±ã•1'
    echo '2 â””æ·±ã•2'
    echo '3 â””æ·±ã•2'
    echo '4   â””æ·±ã•3'    
    echo '5 æ·±ã•1'
    echo '6 â””æ·±ã•2'
    echo ''
    echo 'â†’æŒ‡å®šãƒãƒ¼ãƒ‰=3ã®ã¨ãã€ã‚°ãƒ«ãƒ¼ãƒ—ã¯3ã€œ4'
    echo 'â†’æŒ‡å®šãƒãƒ¼ãƒ‰=2ã®ã¨ãã€ã‚°ãƒ«ãƒ¼ãƒ—ã¯2ã ã‘'
    echo 'â†’æŒ‡å®šãƒãƒ¼ãƒ‰=1ã®ã¨ãã€ã‚°ãƒ«ãƒ¼ãƒ—ã¯1ã€œ4'
    echo ''
    echo 'ãƒ•ã‚¡ãƒŸãƒªãƒ¼ã®ã‚³ãƒãƒ³ãƒ‰ã”ã¨ã«è¡¨ç¤ºã•ã‚Œã‚‹æƒ…å ±ãŒç•°ãªã‚Šã¾ã™ã€‚'
    echo '(åŸºæœ¬çš„ã«tã‚³ãƒãƒ³ãƒ‰ã¨åŒã˜æƒ…å ±ãŒå‚ç…§ã§ãã¾ã™ã€‚)'
    echo ''
    echo '+--------+--------+------+------+----+------+------+------+------+--------+--------+'
    echo '|ã‚³ãƒãƒ³ãƒ‰|nodeç•ªå·|é–‹å§‹è¡Œ|çµ‚äº†è¡Œ|æ·±ã•|æ–‡å­—æ•°|æ¸ˆæœªæ¸ˆ|å¯è¦–æ€§|ãƒ„ãƒªãƒ¼|å±æ€§è¨˜å·|ã‚¿ã‚¤ãƒˆãƒ«|'
    echo '+--------+--------+------+------+----+------+------+------+------+--------+--------+'
    echo '|    f   |   ï¼Š   |      |      |    |      |  ï¼Š  |      |  ï¼Š  |   ï¼Š   |   ï¼Š   |'
    echo '|   fl   |   ï¼Š   |  ï¼Š  |      |    |  ï¼Š  |  ï¼Š  |      |  ï¼Š  |   ï¼Š   |   ï¼Š   |'
    echo '|   fa   |   ï¼Š   |  ï¼Š  |  ï¼Š  | ï¼Š |  ï¼Š  |  ï¼Š  |  ï¼Š  |  ï¼Š  |   ï¼Š   |   ï¼Š   |'
    echo '+--------+--------+------+------+----+------+------+------+------+--------+--------+'
  }
  function help-v {
    clear
    echo 'â– vç³»ã‚³ãƒãƒ³ãƒ‰ ãƒ˜ãƒ«ãƒ—'
    echo 'æ›¸å¼: (bash) wrigglekick.sh [å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] v/gv [å¯¾è±¡ãƒãƒ¼ãƒ‰ç•ªå·]'
    echo ''
    echo 'vç³»ã‚³ãƒãƒ³ãƒ‰([v]iew)ã«ã¯ã€ä»–ã«gv([g]roup [v]iew)ã®ãƒ•ã‚¡ãƒŸãƒªãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚'
    echo ''
    echo 'vç³»ã‚³ãƒãƒ³ãƒ‰ã¯ç·¨é›†ã‚’è¡Œã‚ãªã„å‰æã§ã€å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®æŒ‡å®šãƒãƒ¼ãƒ‰ã‚’é–²è¦§ã—ã¾ã™ã€‚'
    echo 'é–²è¦§ã¯ã€å½“ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒç¨¼åƒã™ã‚‹ç’°å¢ƒã«ã‚ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãƒ“ãƒ¥ãƒ¼ã‚¢ã‚’å‘¼ã³å‡ºã™å½¢ã§å®Ÿç¾ã•ã‚Œã¾ã™ã€‚'
    echo 'å½“ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†’é ­ã®å¤‰æ•°ã€Œselected_viewerã€ã®å€¤ã‚’ã€ä»»æ„ã®ãƒ“ãƒ¥ãƒ¼ã‚¢å‘¼ã³å‡ºã—ã‚³ãƒãƒ³ãƒ‰(ä¾‹ãˆã°lessãªã©)ã«ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚'
    echo 'æŒ‡å®šãŒãªã„å ´åˆã€less > more > view > cat ã®å„ªå…ˆé †ã§å­˜åœ¨ã™ã‚‹ã‚‚ã®ãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚'
    echo 'ãƒ“ãƒ¥ãƒ¼ãƒ¯ã¨ã—ã¦nanoã®ã‚ˆã†ãªã‚¨ãƒ‡ã‚£ã‚¿ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ãŒã€æ­£å¸¸å‹•ä½œã¯ä¿è¨¼ã—ã¾ã›ã‚“ã€‚'
    echo ''
    echo 'gvã‚³ãƒãƒ³ãƒ‰ã®å ´åˆã€æŒ‡å®šãƒãƒ¼ãƒ‰ã‚’å…ˆé ­ã¨ã—ãŸã‚°ãƒ«ãƒ¼ãƒ—ã‚’æ¨ªæ–­çš„ã«é–²è¦§ã—ã¾ã™ã€‚'
    echo ''
    echo 'â€»ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã¯ã€'
    echo 'æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ã‹ã‚‰ãƒãƒ¼ãƒ‰ç•ªå·ã‚’ä¸‹ã£ã¦ã„ã'
    echo 'æœ€åˆã«ã€ŒåŸºæº–ã¨åŒã˜ã‹åŸºæº–ã‚ˆã‚Šæµ…ã„ãƒãƒ¼ãƒ‰ã€ãŒç™ºè¦‹ã•ã‚ŒãŸã¨ãã«ã€'
    echo 'æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ã€œç™ºè¦‹ã•ã‚ŒãŸãƒãƒ¼ãƒ‰ã®ä¸€ã¤æ‰‹å‰ã¾ã§ã®ç¯„å›²ã‚’æŒ‡ã—ã¾ã™ã€‚'
    echo 'æœ€å¾Œå°¾ã®ãƒãƒ¼ãƒ‰ã«åˆ°é”ã—ã¦ã‚‚åŸºæº–ã¨åŒã˜ã‹ãã‚Œã‚ˆã‚Šæµ…ã„ãƒãƒ¼ãƒ‰ãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸå ´åˆã¯'
    echo 'æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ã€œæœ€å¾Œå°¾ã®ãƒãƒ¼ãƒ‰ã‚’ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã—ã¾ã™ã€‚'
    echo ''
    echo 'ex:'
    echo '1 æ·±ã•1'
    echo '2 â””æ·±ã•2'
    echo '3 â””æ·±ã•2'
    echo '4   â””æ·±ã•3'    
    echo '5 æ·±ã•1'
    echo '6 â””æ·±ã•2'
    echo ''
    echo 'â†’æŒ‡å®šãƒãƒ¼ãƒ‰=3ã®ã¨ãã€ã‚°ãƒ«ãƒ¼ãƒ—ã¯3ã€œ4'
    echo 'â†’æŒ‡å®šãƒãƒ¼ãƒ‰=2ã®ã¨ãã€ã‚°ãƒ«ãƒ¼ãƒ—ã¯2ã ã‘'
    echo 'â†’æŒ‡å®šãƒãƒ¼ãƒ‰=1ã®ã¨ãã€ã‚°ãƒ«ãƒ¼ãƒ—ã¯1ã€œ4'
  }
  function help-m {
    clear
    echo 'â– mç³»ã‚³ãƒãƒ³ãƒ‰ ãƒ˜ãƒ«ãƒ—'
    echo 'æ›¸å¼: (bash) wrigglekick.sh [å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] mu/ml/md/mr [å¯¾è±¡ãƒãƒ¼ãƒ‰ç•ªå·]'
    echo ''
    echo 'mç³»ã‚³ãƒãƒ³ãƒ‰([m]ove)ã«ã¯ã€mu([m]ove [u]p)ã€md([m]ove [d]own)ã€ml([m]ove [l]eft)ã€mr([m]ove [r]ight)ã®ãƒ•ã‚¡ãƒŸãƒªãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚'
    echo ''
    echo 'ãã‚Œãã‚Œã€æŒ‡å®šã®ãƒãƒ¼ãƒ‰ã®ä½ç½®ã‚’å¤‰æ›´ã—ã¾ã™ã€‚'
    echo ''
    echo 'ml([m]ove [l]eft)ã‚³ãƒãƒ³ãƒ‰ã¯ã€æŒ‡å®šã®ãƒãƒ¼ãƒ‰ã‚’ã€ä¸€ã¤å·¦ã«ç§»å‹•ã—ã¾ã™ã€‚ã¤ã¾ã‚Šã€æ·±ã•ã‚’ä¸€ã¤æµ…ãã—ã¾ã™ã€‚'
    echo 'mr([m]ove [r]ight)ã‚³ãƒãƒ³ãƒ‰ã¯ã€æŒ‡å®šã®ãƒãƒ¼ãƒ‰ã‚’ã€ä¸€ã¤å³ã«ç§»å‹•ã—ã¾ã™ã€‚ã¤ã¾ã‚Šã€æ·±ã•ã‚’ä¸€ã¤æ·±ãã—ã¾ã™ã€‚'
    echo 'mu([m]ove [u]p)ã‚³ãƒãƒ³ãƒ‰ã¯ã€æŒ‡å®šã®ãƒãƒ¼ãƒ‰ã‚’ã€ä¸€ã¤ä¸Šã«ç§»å‹•ã—ã¾ã™ã€‚ã¤ã¾ã‚Šã€ä¸€ã¤ä¸Šã®ãƒãƒ¼ãƒ‰ã¨å…¥ã‚Œæ›¿ãˆã¾ã™ã€‚'
    echo 'md([m]ove [d]own)ã‚³ãƒãƒ³ãƒ‰ã¯ã€æŒ‡å®šã®ãƒãƒ¼ãƒ‰ã‚’ã€ä¸€ã¤ä¸‹ã«ç§»å‹•ã—ã¾ã™ã€‚ã¤ã¾ã‚Šã€ä¸€ã¤ä¸‹ã®ãƒãƒ¼ãƒ‰ã¨å…¥ã‚Œæ›¿ãˆã¾ã™ã€‚'
    echo ''
    echo 'â€»ã“ã®ç§»å‹•ã‚’ãƒãƒ¼ãƒ‰ä¸€ã¤ã§ã¯ãªãã€ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨è¡Œã†gmã‚³ãƒãƒ³ãƒ‰ãƒ•ã‚¡ãƒŸãƒªãƒ¼ã‚‚å­˜åœ¨ã—ã¾ã™ã€‚'
  }
  function help-gm {
    clear
    echo 'â– gmç³»ã‚³ãƒãƒ³ãƒ‰ ãƒ˜ãƒ«ãƒ—'
    echo 'æ›¸å¼: (bash) wrigglekick.sh [å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] gmu/gml/gmd/gmr [å¯¾è±¡ãƒãƒ¼ãƒ‰ç•ªå·]'
    echo ''
    echo 'gmç³»ã‚³ãƒãƒ³ãƒ‰([g]roup [m]ove)ã«ã¯ã€'
    echo 'gmu([g]roup [m]ove [u]p)ã€gmd([g]roup[m]ove [d]own)ã€gml([g]roup [m]ove [l]eft)ã€gmr([g]roup [m]ove [r]ight)'
    echo 'ã®ãƒ•ã‚¡ãƒŸãƒªãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚'
    echo ''
    echo 'ãã‚Œãã‚Œã€æŒ‡å®šã®ãƒãƒ¼ãƒ‰ã‚’å…ˆé ­ã¨ã—ãŸã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨ã€ä½ç½®ã‚’å¤‰æ›´ã—ã¾ã™ã€‚'
    echo ''
    echo 'gml([g]roup [m]ove [l]eft)ã‚³ãƒãƒ³ãƒ‰ã¯ã€'
    echo 'æŒ‡å®šã®ãƒãƒ¼ãƒ‰ã‚’å…ˆé ­ã¨ã—ãŸã‚°ãƒ«ãƒ¼ãƒ—å…¨ä½“ã‚’ã€ä¸€ã¤å·¦ã«ç§»å‹•ã—ã¾ã™ã€‚ã¤ã¾ã‚Šã€æ·±ã•ã‚’ä¸€ã¤æµ…ãã—ã¾ã™ã€‚'
    echo 'gmr([g]roup [m]ove [r]ight)ã‚³ãƒãƒ³ãƒ‰ã¯ã€'
    echo 'æŒ‡å®šã®ãƒãƒ¼ãƒ‰ã‚’å…ˆé ­ã¨ã—ãŸã‚°ãƒ«ãƒ¼ãƒ—å…¨ä½“ã‚’ã€ä¸€ã¤å³ã«ç§»å‹•ã—ã¾ã™ã€‚ã¤ã¾ã‚Šã€æ·±ã•ã‚’ä¸€ã¤æ·±ãã—ã¾ã™ã€‚'
    echo 'gmu([g]roup [m]ove [u]p)ã‚³ãƒãƒ³ãƒ‰ã¯ã€'
    echo 'æŒ‡å®šã®ãƒãƒ¼ãƒ‰å…ˆé ­ã¨ã—ãŸã‚°ãƒ«ãƒ¼ãƒ—å…¨ä½“ã‚’ã€ä¸€ã¤ä¸Šã«ã‚ã‚‹ã€åŒã˜æ·±ã•ã®ã‚°ãƒ«ãƒ¼ãƒ—å…¨ä½“ã¨å…¥ã‚Œæ›¿ãˆã¾ã™ã€‚'
    echo 'gmd([g]roup [m]ove [d]own)ã‚³ãƒãƒ³ãƒ‰ã¯ã€'
    echo 'æŒ‡å®šã®ãƒãƒ¼ãƒ‰å…ˆé ­ã¨ã—ãŸã‚°ãƒ«ãƒ¼ãƒ—å…¨ä½“ã‚’ã€ä¸€ã¤ä¸‹ã«ã‚ã‚‹ã€åŒã˜æ·±ã•ã®ã‚°ãƒ«ãƒ¼ãƒ—å…¨ä½“ã¨å…¥ã‚Œæ›¿ãˆã¾ã™ã€‚'
    echo ''
    echo 'â€»ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã¯ã€'
    echo 'æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ã‹ã‚‰ãƒãƒ¼ãƒ‰ç•ªå·ã‚’ä¸‹ã£ã¦ã„ã'
    echo 'æœ€åˆã«ã€ŒåŸºæº–ã¨åŒã˜ã‹åŸºæº–ã‚ˆã‚Šæµ…ã„ãƒãƒ¼ãƒ‰ã€ãŒç™ºè¦‹ã•ã‚ŒãŸã¨ãã«ã€'
    echo 'æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ã€œç™ºè¦‹ã•ã‚ŒãŸãƒãƒ¼ãƒ‰ã®ä¸€ã¤æ‰‹å‰ã¾ã§ã®ç¯„å›²ã‚’æŒ‡ã—ã¾ã™ã€‚'
    echo 'æœ€å¾Œå°¾ã®ãƒãƒ¼ãƒ‰ã«åˆ°é”ã—ã¦ã‚‚åŸºæº–ã¨åŒã˜ã‹ãã‚Œã‚ˆã‚Šæµ…ã„ãƒãƒ¼ãƒ‰ãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸå ´åˆã¯'
    echo 'æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ã€œæœ€å¾Œå°¾ã®ãƒãƒ¼ãƒ‰ã‚’ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã—ã¾ã™ã€‚'
    echo ''
    echo 'ex:'
    echo '1 æ·±ã•1'
    echo '2 â””æ·±ã•2'
    echo '3 â””æ·±ã•2'
    echo '4   â””æ·±ã•3'    
    echo '5 æ·±ã•1'
    echo '6 â””æ·±ã•2'
    echo ''
    echo 'gmd 1 ã¨ã—ãŸã¨ãã€'
    echo 'ãƒãƒ¼ãƒ‰ç•ªå·1ã¨åŒã˜æ·±ã•ã‚’æŒã¤æ¬¡ã®ãƒãƒ¼ãƒ‰ã‚’å…ˆé ­ã¨ã—ãŸã‚°ãƒ«ãƒ¼ãƒ—ã¨ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨å…¥ã‚Œæ›¿ã‚ã‚‹ãŸã‚ã€å®Ÿè¡Œå¾Œã¯'
    echo ''
    echo '1 æ·±ã•1'
    echo '2 â””æ·±ã•2'
    echo '3 æ·±ã•1'
    echo '4 â””æ·±ã•2'
    echo '5 â””æ·±ã•2'
    echo '6   â””æ·±ã•3'
    echo ''
    echo 'ã¨ãªã‚Šã¾ã™'
    echo ''
    echo 'ä¸Šä¸‹ã«åŒã˜æ·±ã•ã®åˆ¥ã‚°ãƒ«ãƒ¼ãƒ—ãŒå­˜åœ¨ã—ãªã‹ã£ãŸå ´åˆã€ç§»å‹•ã•ã‚Œãšã«çµ‚äº†ã—ã¾ã™ã€‚'
    echo 'å…ˆé ­ãƒãƒ¼ãƒ‰ãŒã™ã§ã«æ·±ã•1ã®ã¨ãã«ã¯ã€gmlã‚³ãƒãƒ³ãƒ‰ã¯å‡¦ç†ã•ã‚Œãšã«çµ‚äº†ã—ã¾ã™ã€‚'
    echo 'æ·±ã•ã«ã¯åˆ¶é™ã‚’è¨­ã‘ã¦ã„ãªã„ã®ã§gmrã‚³ãƒãƒ³ãƒ‰ã¯å¿…ãšç§»å‹•ã—ã¾ã™ãŒã€ã‚ã¾ã‚Šæ·±ã™ãã‚‹å ´åˆã®å‹•ä½œã®ä¿è¨¼ã¯ã—ã¾ã›ã‚“ã€‚'
  }
  function help-d {
    clear
    echo 'â– dç³»ã‚³ãƒãƒ³ãƒ‰ ãƒ˜ãƒ«ãƒ—'
    echo 'æ›¸å¼: (bash) wrigglekick.sh [å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] d/gd [å¯¾è±¡ãƒãƒ¼ãƒ‰ç•ªå·]'
    echo ''
    echo 'dç³»ã‚³ãƒãƒ³ãƒ‰([d]elete)ã«ã¯ã€gd([g]roup [d]elete)ã®ãƒ•ã‚¡ãƒŸãƒªãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚'
    echo ''
    echo 'dã‚³ãƒãƒ³ãƒ‰ã¯ã€æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ã‚’å‰Šé™¤ã—ã¾ã™ã€‚'
    echo ''
    echo 'gdã‚³ãƒãƒ³ãƒ‰ã¯ã€'
    echo 'æŒ‡å®šã®ãƒãƒ¼ãƒ‰ã‚’å…ˆé ­ã¨ã—ãŸã‚°ãƒ«ãƒ¼ãƒ—å…¨ä½“ã‚’ã€ä¸€æ°—ã«å‰Šé™¤ã—ã¾ã™ã€‚'
    echo ''
    echo 'â€»ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã¯ã€'
    echo 'æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ã‹ã‚‰ãƒãƒ¼ãƒ‰ç•ªå·ã‚’ä¸‹ã£ã¦ã„ã'
    echo 'æœ€åˆã«ã€ŒåŸºæº–ã¨åŒã˜ã‹åŸºæº–ã‚ˆã‚Šæµ…ã„ãƒãƒ¼ãƒ‰ã€ãŒç™ºè¦‹ã•ã‚ŒãŸã¨ãã«ã€'
    echo 'æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ã€œç™ºè¦‹ã•ã‚ŒãŸãƒãƒ¼ãƒ‰ã®ä¸€ã¤æ‰‹å‰ã¾ã§ã®ç¯„å›²ã‚’æŒ‡ã—ã¾ã™ã€‚'
    echo 'æœ€å¾Œå°¾ã®ãƒãƒ¼ãƒ‰ã«åˆ°é”ã—ã¦ã‚‚åŸºæº–ã¨åŒã˜ã‹ãã‚Œã‚ˆã‚Šæµ…ã„ãƒãƒ¼ãƒ‰ãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸå ´åˆã¯'
    echo 'æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ã€œæœ€å¾Œå°¾ã®ãƒãƒ¼ãƒ‰ã‚’ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã—ã¾ã™ã€‚'
    echo ''
    echo 'ex:'
    echo '1 æ·±ã•1'
    echo '2 â””æ·±ã•2'
    echo '3 â””æ·±ã•2'
    echo '4   â””æ·±ã•3'    
    echo '5 æ·±ã•1'
    echo '6 â””æ·±ã•2'
    echo ''
    echo 'gd 3 ã¨ã—ãŸã¨ãã€å®Ÿè¡Œå¾Œã¯'
    echo ''
    echo '1 æ·±ã•1'
    echo '2 â””æ·±ã•2'
    echo '3 æ·±ã•1'
    echo '4 â””æ·±ã•2'
    echo ''
    echo 'ã¨ãªã‚Šã¾ã™ã€‚'
  }
  function help-j {
    clear
    echo 'â– jç³»ã‚³ãƒãƒ³ãƒ‰ ãƒ˜ãƒ«ãƒ—'
    echo 'æ›¸å¼: (bash) wrigglekick.sh [å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] j [å¯¾è±¡ãƒãƒ¼ãƒ‰ç•ªå·]'
    echo ''
    echo 'jç³»ã‚³ãƒãƒ³ãƒ‰([j]oin)ã«ã¯ã€ä»Šã®ã¨ã“ã‚ä»–ã®ãƒ•ã‚¡ãƒŸãƒªãƒ¼ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚'
    echo ''
    echo 'jã‚³ãƒãƒ³ãƒ‰ã¯ã€æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ã¨ãã®ã²ã¨ã¤ä¸‹ã®ãƒãƒ¼ãƒ‰ã‚’çµåˆã—ã¦ã€ä¸€ã¤ã®ãƒãƒ¼ãƒ‰ã«ã—ã¾ã™ã€‚'
    echo 'ãƒãƒ¼ãƒ‰ã®åç§°ã‚„æ·±ã•ã¯ã€æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ã®ã‚‚ã®ã«ãªã‚Šã¾ã™ã€‚'
  }
  function help-k {
    clear
    echo 'â– kç³»ã‚³ãƒãƒ³ãƒ‰ ãƒ˜ãƒ«ãƒ—'
    echo 'æ›¸å¼: (bash) wrigglekick.sh [å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] k/gk [å¯¾è±¡ãƒãƒ¼ãƒ‰ç•ªå·]'
    echo ''
    echo 'kç³»ã‚³ãƒãƒ³ãƒ‰(chec[k])ã«ã¯ã€ä»–ã«gkã‚³ãƒãƒ³ãƒ‰([g]roup chec[k])ãŒã‚ã‚Šã¾ã™ã€‚'
    echo ''
    echo 'kã‚³ãƒãƒ³ãƒ‰ã¯ã€æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ã®å®Œäº†ãƒ•ãƒ©ã‚°ã®ã‚ªãƒ³ã‚ªãƒ•ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™'
    echo 'ç¾åœ¨æœªå®Œäº†çŠ¶æ…‹ã®å ´åˆã¯å®Œäº†ã«ã€å®Œäº†çŠ¶æ…‹ã®å ´åˆã¯æœªå®Œäº†ã«ãªã‚Šã¾ã™ã€‚'
    echo ''
    echo 'gkã‚³ãƒãƒ³ãƒ‰ã¯ã€æŒ‡å®šã—ãŸã‚°ãƒ«ãƒ¼ãƒ—å…¨ä½“ã®å®Œäº†/æœªäº†ã‚’è¨­å®šã—ã¾ã™ã€‚'
    echo 'kã‚³ãƒãƒ³ãƒ‰ã¨ç•°ãªã‚Šã€åˆ‡ã‚Šæ›¿ãˆã§ã¯ãªãã€è¿½åŠ å¼•æ•°ã¨ã—ã¦0ã‚’ä¸ãˆã‚‹ã¨æœªäº†ã€1ã‚’ä¸ãˆã‚‹ã¨å®Œäº†ã«ãªã‚Šã€'
    echo 'ã‚°ãƒ«ãƒ¼ãƒ—å†…ã®ãƒãƒ¼ãƒ‰ã™ã¹ã¦ã‚’å®Œäº†ã€ã¾ãŸã¯æœªäº†ã«ã—ã¾ã™ã€‚'
    echo ''
    echo 'â€»ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã¯ã€'
    echo 'æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ã‹ã‚‰ãƒãƒ¼ãƒ‰ç•ªå·ã‚’ä¸‹ã£ã¦ã„ã'
    echo 'æœ€åˆã«ã€ŒåŸºæº–ã¨åŒã˜ã‹åŸºæº–ã‚ˆã‚Šæµ…ã„ãƒãƒ¼ãƒ‰ã€ãŒç™ºè¦‹ã•ã‚ŒãŸã¨ãã«ã€'
    echo 'æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ã€œç™ºè¦‹ã•ã‚ŒãŸãƒãƒ¼ãƒ‰ã®ä¸€ã¤æ‰‹å‰ã¾ã§ã®ç¯„å›²ã‚’æŒ‡ã—ã¾ã™ã€‚'
    echo 'æœ€å¾Œå°¾ã®ãƒãƒ¼ãƒ‰ã«åˆ°é”ã—ã¦ã‚‚åŸºæº–ã¨åŒã˜ã‹ãã‚Œã‚ˆã‚Šæµ…ã„ãƒãƒ¼ãƒ‰ãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸå ´åˆã¯'
    echo 'æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ã€œæœ€å¾Œå°¾ã®ãƒãƒ¼ãƒ‰ã‚’ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã—ã¾ã™ã€‚'
  }
  function help-gc {
    clear
    echo 'â– gcç³»ã‚³ãƒãƒ³ãƒ‰ ãƒ˜ãƒ«ãƒ—'
    echo 'æ›¸å¼: (bash) wrigglekick.sh [å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] gc [å¯¾è±¡ãƒãƒ¼ãƒ‰ç•ªå·]'
    echo ''
    echo 'gcç³»ã‚³ãƒãƒ³ãƒ‰([g]roup [c]ount)ã«ã¯ã€ä»Šã®ã¨ã“ã‚ä»–ã®ãƒ•ã‚¡ãƒŸãƒªãƒ¼ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚'
    echo ''
    echo 'gcã‚³ãƒãƒ³ãƒ‰ã¯ã€æŒ‡å®šã—ãŸã‚°ãƒ«ãƒ¼ãƒ—å†…å…¨ä½“ã®æ–‡å­—æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã—ã¦è¡¨ç¤ºã—ã¾ã™ã€‚'
    echo 'ä½†ã—ã“ã®æ–‡å­—æ•°ã«ã¯ã€ã€Œ//ã€ã§å§‹ã¾ã‚‹ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆè¡Œã®æ–‡å­—æ•°ã¯åˆè¨ˆã•ã‚Œã¾ã›ã‚“ã€‚'
  }
  function help-h {
    clear
    echo 'â– hç³»ã‚³ãƒãƒ³ãƒ‰ ãƒ˜ãƒ«ãƒ—'
    echo 'æ›¸å¼: (bash) wrigglekick.sh [å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] h/gh [å¯¾è±¡ãƒãƒ¼ãƒ‰ç•ªå·] ([0/1])'
    echo ''
    echo 'hç³»ã‚³ãƒãƒ³ãƒ‰([h]ide)ã«ã¯ã€ä»–ã«gh([g]roup [h]ide)ã®ãƒ•ã‚¡ãƒŸãƒªãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚'
    echo ''
    echo 'hã‚³ãƒãƒ³ãƒ‰ã¯ã€æŒ‡å®šã®ãƒãƒ¼ãƒ‰ã®ä¸å¯è¦–ãƒ•ãƒ©ã‚°ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™ã€‚'
    echo 'ç¾åœ¨ä¸å¯è¦–ã®å ´åˆã¯å¯è¦–ã«ã€å¯è¦–ã®å ´åˆã¯ä¸å¯è¦–ã«ãªã‚Šã¾ã™ã€‚'
    echo ''
    echo 'ä¸å¯è¦–è¨­å®šã•ã‚ŒãŸãƒãƒ¼ãƒ‰ã¯ã€tã‚³ãƒãƒ³ãƒ‰ã€fã‚³ãƒãƒ³ãƒ‰ã«ã¦ã€è¿½åŠ ã®å¼•æ•°hã‚’æŒ‡å®šã—ãŸå ´åˆã«è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“'
    echo '(è¿½åŠ å¼•æ•°hã‚’ä»˜ä¸ã—ãªã„å ´åˆã¯ä½•ã‚‚å½±éŸ¿ã‚’ä¸ãˆã¾ã›ã‚“)'
    echo ''    
    echo 'ghã‚³ãƒãƒ³ãƒ‰ã¯ã€æŒ‡å®šã—ãŸã‚°ãƒ«ãƒ¼ãƒ—å…¨ä½“ã®å¯è¦–/ä¸å¯è¦–ã‚’è¨­å®šã—ã¾ã™ã€‚'
    echo 'hã‚³ãƒãƒ³ãƒ‰ã¨ç•°ãªã‚Šã€åˆ‡ã‚Šæ›¿ãˆã§ã¯ãªãã€è¿½åŠ å¼•æ•°ã¨ã—ã¦0ã‚’ä¸ãˆã‚‹ã¨å¯è¦–ã€1ã‚’ä¸ãˆã‚‹ã¨ä¸å¯è¦–ã«ãªã‚Šã€'
    echo 'ã‚°ãƒ«ãƒ¼ãƒ—å†…ã®ãƒãƒ¼ãƒ‰ã™ã¹ã¦ã‚’å¯è¦–ã€ã¾ãŸã¯ä¸å¯è¦–ã«ã—ã¾ã™ã€‚'
  }
  function help-s {
    clear
    echo 'â– sç³»ã‚³ãƒãƒ³ãƒ‰ ãƒ˜ãƒ«ãƒ—'
    echo 'æ›¸å¼: (bash) wrigglekick.sh [å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] s [å¯¾è±¡ãƒãƒ¼ãƒ‰ç•ªå·] [ä»»æ„ã®æ–‡å­—]'
    echo ''
    echo 'sç³»ã‚³ãƒãƒ³ãƒ‰([s]imbol)ã«ã¯ã€ä»–ã«ã¯ãƒ•ã‚¡ãƒŸãƒªãƒ¼ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚'
    echo ''
    echo 'sã‚³ãƒãƒ³ãƒ‰ã¯ã€æŒ‡å®šã®ãƒãƒ¼ãƒ‰ã«ä»»æ„ã®ä¸€æ–‡å­—ã®å±æ€§ã‚’ä»˜ä¸ã—ã¾ã™ã€‚'
    echo 'å±æ€§ã‚’ç¤ºã™æ–‡å­—ã¯çµµæ–‡å­—ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ãŒã€æ–‡å­—ãªã‚‰ä½•ã§ã‚‚è‰¯ã„ã§ã™ã€‚'
    echo 'å±æ€§ã‚’æ¶ˆã™å ´åˆã¯ã€è¨˜å·ã¨ã—ã¦ç©ºæ–‡å­—ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚'
  }
  function help-i {
    clear
    echo 'â– iç³»ã‚³ãƒãƒ³ãƒ‰ ãƒ˜ãƒ«ãƒ—'
    echo 'æ›¸å¼: (bash) wrigglekick.sh [å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] i/ie [å¯¾è±¡ãƒãƒ¼ãƒ‰ç•ªå·] [ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒˆãƒ«]'
    echo ''
    echo 'iç³»ã‚³ãƒãƒ³ãƒ‰([i]nsert)ã«ã¯ã€ä»–ã«ie([i]nsert [e]dit)ã®ãƒ•ã‚¡ãƒŸãƒªãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚'
    echo ''
    echo 'iã‚³ãƒãƒ³ãƒ‰ã¯ã€æŒ‡å®šã®ãƒãƒ¼ãƒ‰ã®å¾Œã‚ã«æ–°ã—ã„ãƒãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚'
    echo 'ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒˆãƒ«ã®æŒ‡å®šãŒãªã„å ´åˆã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚¿ã‚¤ãƒˆãƒ«ãŒä»˜ä¸ã•ã‚Œã¾ã™ã€‚'
    echo ''
    echo 'ieã‚³ãƒãƒ³ãƒ‰ã¯ã€æŒ‡å®šã®ãƒãƒ¼ãƒ‰ã®å¾Œã‚ã«æ–°ã—ã„ãƒãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ãŸå¾Œã€ã™ãã«ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«å…¥ã‚Šã¾ã™ã€‚'
    echo 'â€»ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«ã¤ã„ã¦ã¯ã€eã‚³ãƒãƒ³ãƒ‰ã®ãƒ˜ãƒ«ãƒ—ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚'
    echo 'iã‚³ãƒãƒ³ãƒ‰åŒæ§˜ã€ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒˆãƒ«ã®æŒ‡å®šãŒãªã„å ´åˆã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚¿ã‚¤ãƒˆãƒ«ãŒä»˜ä¸ã•ã‚Œã¾ã™ã€‚'
  }
  function help-o {
    clear
    echo 'â– oç³»ã‚³ãƒãƒ³ãƒ‰ ãƒ˜ãƒ«ãƒ—'
    echo 'æ›¸å¼: (bash) wrigglekick.sh [å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] o [å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«å]'
    echo ''
    echo 'oç³»ã‚³ãƒãƒ³ãƒ‰([o]utput)ã«ã¯ã€ä»Šã®ã¨ã“ã‚ä»–ã®ãƒ•ã‚¡ãƒŸãƒªãƒ¼ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚'
    echo ''
    echo 'oã‚³ãƒãƒ³ãƒ‰ã¯ã€æŒ‡å®šã®ãƒãƒ¼ãƒ‰ã‚’å…ˆé ­ã¨ã™ã‚‹ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ã€å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«åã¨ã—ã¦åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã—ã¾ã™ã€‚'
    echo 'â€»æŒ‡å®šãƒãƒ¼ãƒ‰å˜ä¸€ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚å˜ä¸€ãƒãƒ¼ãƒ‰ã ã‘ã‚’æ›¸ãå‡ºã™å¿…è¦ãŒå‡ºãŸã‚‰ä½œã‚Šã¾ã™'
    echo 'å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«åã®æŒ‡å®šãŒãªã„å ´åˆã¯ã€æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰ã®ã‚¿ã‚¤ãƒˆãƒ«ãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚'
    echo ''
    echo 'oã‚³ãƒãƒ³ãƒ‰ã§å‡ºåŠ›ã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ã€Œ//ã€ã§å§‹ã¾ã‚‹ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆè¡Œã¯å«ã¾ã‚Œã¾ã›ã‚“ã€‚'
  }
  function help-e {
    clear
    echo 'â– eç³»ã‚³ãƒãƒ³ãƒ‰ ãƒ˜ãƒ«ãƒ—'
    echo 'æ›¸å¼: (bash) wrigglekick.sh [å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] (e) [å¯¾è±¡ãƒãƒ¼ãƒ‰ç•ªå·]'
    echo ''
    echo 'eç³»ã‚³ãƒãƒ³ãƒ‰([v]iew)ã«ã¯ã€ä»–ã«ã¯ãƒ•ã‚¡ãƒŸãƒªãƒ¼ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚'
    echo ''
    echo 'eã‚³ãƒãƒ³ãƒ‰ã®ã¿ã€ã‚³ãƒãƒ³ãƒ‰è‡ªä½“ã‚’çœç•¥ã§ãã¾ã™ã€‚å³ã¡'
    echo '(bash) wrigglekick.sh [å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] [å¯¾è±¡ãƒãƒ¼ãƒ‰ç•ªå·]'
    echo 'ã¨è¡¨è¨˜ã—ãŸå ´åˆã«ã¯ã€ãã‚Œã¯eã‚³ãƒãƒ³ãƒ‰ã¨ã¿ãªã—ã¾ã™ã€‚'
    echo ''
    echo 'eç³»ã‚³ãƒãƒ³ãƒ‰ã¯å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®æŒ‡å®šãƒãƒ¼ãƒ‰ã‚’ã‚¨ãƒ‡ã‚£ã‚¿ã¸æ¸¡ã—ã¾ã™ã€‚'
    echo 'å½“ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã¯ã€ç·¨é›†ã¯ç¨¼åƒã™ã‚‹ç’°å¢ƒã«ã‚ã‚‹ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã‚’å‘¼ã³å‡ºã™å½¢ã§å®Ÿç¾ã•ã‚Œã¾ã™ã€‚'
    echo 'å½“ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†’é ­ã®å¤‰æ•°ã€Œselected_editorã€ã®å€¤ã‚’ã€ä»»æ„ã®ã‚¨ãƒ‡ã‚£ã‚¿å‘¼ã³å‡ºã—ã‚³ãƒãƒ³ãƒ‰(ä¾‹ãˆã°viãªã©)ã«ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚'
    echo 'æŒ‡å®šãŒãªã„å ´åˆã€ms_edit > micro > nano > vi > ed ã®å„ªå…ˆé †ã§å­˜åœ¨ã™ã‚‹ã‚‚ã®ãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚'
  }

  function displayHelp {
    local command="${1}"
    case "${command}" in
      't'|'tl'|'ta') help-t;;
      'f'|'fl'|'fa') help-f;;
      'v'|'gv') help-v;;
      'm'|'mu'|'md'|'ml'|'mr') help-m;;
      'gm'|'gmu'|'gmd'|'gml'|'gmr') help-gm;;
      'd'|'gd') help-d;;
      'j'|'gj') help-j;;
      'gc') help-gc;;
      'k') help-k;;
      'h') help-h;;
      's') help-s;;
      'i'|'ie') help-e;;
      'o') help-o;;
      'e') help-o;;
      *) commandList;;
    esac
  }

}

: "ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒˆãƒ«è¡Œã®åˆ†è§£" && {
  ##############################################################################
  # å¤–éƒ¨ãƒ—ãƒ­ã‚»ã‚¹å‘¼ã³å‡ºã—ã‚’é«˜é€ŸåŒ–ã™ã‚‹ãŸã‚ã®å‰å‡¦ç†ç¾¤ 
  ##############################################################################
  function parseMetadata {
    local input="${1}"
    local fieldNum="${2}"
    local metadata="${input#*\[}"
    metadata="${metadata%%\]*}"
    local IFS=','
    local -a fields=($metadata)
    echo "${fields[$((fieldNum-1))]}"
  }
  function arrayContains {
    local target="${1}"
    shift
    local element
    for element in "$@"; do
      [[ "${element}" == "${target}" ]] && return 0
    done
    return 1
  }
}

: "ãƒãƒ¼ãƒ‰æ¤œå‡º" && {
  ##############################################################################
  # ã‚°ãƒ­ãƒ¼ãƒãƒ«é…åˆ—
  ##############################################################################
  declare -a nodeStartLines
  declare -a nodeEndLines
  declare -a nodeDepths
  declare -a nodeTitles
  declare -a nodeProgress
  declare -a nodeSymbols
  declare -a nodeHideFlags
  declare -a nodeCharCount

  ##############################################################################
  # ãƒãƒ¼ãƒ‰æ¤œå‡º
  # å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒ¼ãƒ‰æ§‹æˆã‚’æ¤œå‡ºã—ã¦ã‚°ãƒ­ãƒ¼ãƒãƒ«è¨­å®šã™ã‚‹
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã®ã¿å‚ç…§)
  # ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°è¨­å®š:æœ€å¤§ãƒãƒ¼ãƒ‰æ•°(maxNodeCnt)ã€å„ç¨®é…åˆ—
  ##############################################################################
  function detectNode {

    local entry
    local startLine
    local content      
    local endLine
    local title
    local progress
    local symbol
    local hideFlag
    local depth
    local nextEntry
    local nextStartLine

    readarray -t indexlist < <(grep -nP '^#+\s.+' ${inputFile})
    readarray -t fileLines < "${inputFile}"

    maxNodeCnt="${#indexlist[@]}"
    maxLineCnt="${#fileLines[@]}"

    nodeStartLines=()
    nodeEndLines=()
    nodeDepths=()
    nodeTitles=()
    nodeProgress=()
    nodeSymbols=()
    nodeHideFlags=()
    nodeCharCount=()

    for i in $(seq 1 ${maxNodeCnt}); do
      entry="${indexlist[$((i-1))]}"
      startLine="${entry%%:*}"
      content="${entry#*:}"      

      if [[ ${i} -ne ${maxNodeCnt} ]]; then
        nextEntry="${indexlist[${i}]}"
        nextStartLine="${nextEntry%%:*}"
        endLine=$((nextStartLine - 1))
      else
        endLine="${maxLineCnt}"
      fi
      
      depth="${content}"
      depth="${depth%%[^#]*}"
      depth="${#depth}"
      
      local withoutDepth="${content##*\# }"
      
      title="${withoutDepth%%\[*}"
      title="${title% }"
      
      progress="$(parseMetadata "${withoutDepth}" 1)"
      symbol="$(parseMetadata "${withoutDepth}" 2)"
      symbol="${symbol:0:1}" #1æ–‡å­—ã®ã¿
      hideFlag="$(parseMetadata "${withoutDepth}" 3)"
      hideFlag="${hideFlag:0:1}" #1æ–‡å­—ã®ã¿

      nodeStartLines+=("${startLine}")
      nodeEndLines+=("${endLine}")
      nodeDepths+=("${depth}")
      nodeTitles+=("${title}")
      nodeSymbols+=("${symbol:= }") #è¨­å®šã•ã‚Œã¦ã„ãªã„å ´åˆã«ã¯ç©ºç™½ã‚’ä¸€æ™‚çš„ã«è¨­å®š
      nodeHideFlags+=("${hideFlag:=0}") #è¨­å®šã•ã‚Œã¦ã„ãªã„å ´åˆã«ã¯0ã‚’ä¸€æ™‚çš„ã«è¨­å®š
      nodeProgress+=("${progress:=0}") #è¨­å®šã•ã‚Œã¦ã„ãªã„å ´åˆã«ã¯0ã‚’ä¸€æ™‚çš„ã«è¨­å®š

      #taã‹tlã®å ´åˆä»¥å¤–ã¯ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹

      local countActionList=('tl' 'ta' 'fl' 'fa')
      if arrayContains "${action}" "${countActionList[@]}"; then
        #æ¬¡ã®è¡ŒãŒã™ãã«æ¬¡ã®ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒˆãƒ«è¡Œ(ç´”ç²‹ãªã‚¿ã‚¤ãƒˆãƒ«è¡Œ)ã®å ´åˆã¯0æ–‡å­—
        if [[ ${startLine} -eq ${endLine} ]] ; then
          charCount=0
        else
          local contentLines=""
          for ((lineNum=startLine; lineNum<=endLine; lineNum++)); do
            local line="${fileLines[$((lineNum-1))]}"
            if [[ ! "${line}" =~ ^# ]]; then
              contentLines+="${line}"
            fi
          done
          charCount="${#contentLines}"
        fi
        nodeCharCount+=("${charCount}")
      fi

    done
  }
}

: "ã‚·ãƒ³ãƒœãƒ«ç³»" && {
  ##############################################################################
  # é¸æŠãƒãƒ¼ãƒ‰ã®æ¸ˆãƒãƒ¼ã‚¯(â˜‘ï¸)ã¨æœªæ¸ˆ(â¬œï¸)ã®ãƒãƒ¼ã‚¯ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  ##############################################################################
  function switchProgress {
    
    local presentProgress="${nodeProgress[$((indexNo-1))]:=0}"
    presentProgress="${presentProgress:0:1}" #ä¸æ­£ãªæ–‡å­—ãŒå…¥ã£ã¦ã„ãŸå ´åˆã«1æ–‡å­—ã«å‰Šã‚‹

    if [[ ${presentProgress} -eq 0 ]] ; then
      modifiyProgress=1
    else
      modifiyProgress=0
    fi

    local targetLineNo="${nodeStartLines[$((indexNo-1))]}"

    local depth_markers="$( seq ${nodeDepths[$((indexNo-1))]} | while read -r line; do printf '#'; done )"
    local title="${nodeTitles[$((indexNo-1))]}"
    local symbol="${nodeSymbols[$((indexNo-1))]}"
    local hideFlag="${nodeHideFlags[$((indexNo-1))]}"

    modifiedTitlelineContent="${depth_markers} ${title} [${modifiyProgress},${symbol},${hideFlag}]"

    sed -i "${targetLineNo} c ${modifiedTitlelineContent}" "${inputFile}"

    bash "${0}" "${inputFile}" 'tl'
    exit 0
  }
  ##############################################################################
  # é…ä¸‹ãƒãƒ¼ãƒ‰ã«å®Œäº†ãƒ•ãƒ©ã‚°(1:å®Œäº†/0:æœªå®Œäº†)ã‚’è¨­å®šã€‚æŒ‡å®šã‚·ãƒ³ãƒœãƒ«ã‚’ç©ºã«ã—ãŸå ´åˆã¯0(æœªå®Œäº†)
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  # å¼•æ•°2:ãƒ•ãƒ©ã‚°(1/0)
  ##############################################################################
  function setProgressGroup {
    local SelectGroupNodeFromTo="$(getNodeNoInGroup ${indexNo} '' )"
    local startNodeSelectGroup="$( echo ${SelectGroupNodeFromTo} | cut -d ' ' -f 1 )"
    local endNodeSelectGroup="$( echo ${SelectGroupNodeFromTo} | cut -d ' ' -f 2 )"

    local modifiedTitlelineContent=''
    local modifyFlag="${option:0:1}" #å…ˆé ­1æ–‡å­—ã®ã¿

    local depth_markers=''
    local title=''
    local progress=''
    local symbol=''

    for i in $(seq "${startNodeSelectGroup}" "${endNodeSelectGroup}") ;
    do
      tgtLine="$( getLineNo ${i} 1 )"

      depth_markers="$( seq ${nodeDepths[$((i-1))]} | while read -r line; do printf '#'; done )"
      title="${nodeTitles[$((i-1))]}"
      # progress="${nodeProgress[$((i-1))]}"
      symbol="${nodeSymbols[$((i-1))]}"
      hideFlag="${nodeHideFlags[$((i-1))]}"

      modifiedTitlelineContent="${depth_markers} ${title} [${modifyFlag},${symbol},${hideFlag}]"
      sed -i "${tgtLine}c ${modifiedTitlelineContent}" "${inputFile}"
    done

    bash "${0}" "${inputFile}" 'ta'
    exit 0

  }

  ##############################################################################
  # é¸æŠãƒãƒ¼ãƒ‰ã«ã‚·ãƒ³ãƒœãƒ«ã‚’è¨­å®šã€‚æŒ‡å®šã‚·ãƒ³ãƒœãƒ«ã‚’ç©ºã«ã—ãŸå ´åˆã¯å‰Šé™¤
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  # å¼•æ•°2:è¨­å®šã™ã‚‹ã‚·ãƒ³ãƒœãƒ«(1æ–‡å­—ã®ã¿)
  ##############################################################################
  function setSymbol {

    local modifySymbol="${option:0:1}" #1æ–‡å­—ã®ã¿

    local targetLineNo="${nodeStartLines[$((${indexNo}-1))]}"

    local depth_markers="$( seq ${nodeDepths[$((indexNo-1))]} | while read -r line; do printf '#'; done )"
    local title="${nodeTitles[$((indexNo-1))]}"
    local progress="${nodeProgress[$((indexNo-1))]}"
    local hideFlag="${nodeHideFlags[$((indexNo-1))]}"

    local modifiedTitlelineContent="${depth_markers} ${title} [${progress},${modifySymbol},${hideFlag}]"

    sed -i "${targetLineNo} c ${modifiedTitlelineContent}" "${inputFile}"

    bash "${0}" "${inputFile}" 't'
    exit 0
  }

  ##############################################################################
  # é¸æŠãƒãƒ¼ãƒ‰ã«ä¸å¯è¦–ãƒ•ãƒ©ã‚°ã‚’åˆ‡ã‚Šæ›¿ãˆã€‚æŒ‡å®šã‚·ãƒ³ãƒœãƒ«ã‚’ç©ºã«ã—ãŸå ´åˆã¯0(å¯è¦–)
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  # å¼•æ•°2:ãƒ•ãƒ©ã‚°(1/0)
  ##############################################################################
  function setHideFlag {

    local targetLineNo="${nodeStartLines[$((${indexNo}-1))]}"

    local presentHideFlag="${nodeHideFlags[$((indexNo-1))]:=0}"
    presentHideFlag="${presentHideFlag:0:1}" #ä¸æ­£ãªæ–‡å­—ãŒå…¥ã£ã¦ã„ãŸå ´åˆã«1æ–‡å­—ã«å‰Šã‚‹

    if [[ ${presentHideFlag} -eq 0 ]] ; then
      modifyHideFlag=1
    else
      modifyHideFlag=0
    fi

    local depth_markers="$( seq ${nodeDepths[$((indexNo-1))]} | while read -r line; do printf '#'; done )"
    local title="${nodeTitles[$((indexNo-1))]}"
    local progress="${nodeProgress[$((indexNo-1))]}"
    local symbol="${nodeSymbols[$((indexNo-1))]}"

    local modifiedTitlelineContent="${depth_markers} ${title} [${progress},${symbol},${modifyHideFlag}]"

    sed -i "${targetLineNo} c ${modifiedTitlelineContent}" "${inputFile}"

    bash "${0}" "${inputFile}" 'ta'
    exit 0
  }

  ##############################################################################
  # é…ä¸‹ãƒãƒ¼ãƒ‰ã«ä¸å¯è¦–ãƒ•ãƒ©ã‚°(1:ä¸å¯è¦–/0:å¯è¦–)ã‚’è¨­å®šã€‚æŒ‡å®šã‚·ãƒ³ãƒœãƒ«ã‚’ç©ºã«ã—ãŸå ´åˆã¯0(å¯è¦–)
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  # å¼•æ•°2:ãƒ•ãƒ©ã‚°(1/0)
  ##############################################################################
  function hideGroup {
    local SelectGroupNodeFromTo="$(getNodeNoInGroup ${indexNo} '' )"
    local startNodeSelectGroup="$( echo ${SelectGroupNodeFromTo} | cut -d ' ' -f 1 )"
    local endNodeSelectGroup="$( echo ${SelectGroupNodeFromTo} | cut -d ' ' -f 2 )"

    local modifiedTitlelineContent=''
    local modifyFlag="${option:0:1}" #å…ˆé ­1æ–‡å­—ã®ã¿

    local depth_markers=''
    local title=''
    local progress=''
    local symbol=''

    for i in $(seq "${startNodeSelectGroup}" "${endNodeSelectGroup}") ;
    do
      tgtLine="$( getLineNo ${i} 1 )"

      depth_markers="$( seq ${nodeDepths[$((i-1))]} | while read -r line; do printf '#'; done )"
      title="${nodeTitles[$((i-1))]}"
      progress="${nodeProgress[$((i-1))]}"
      symbol="${nodeSymbols[$((i-1))]}"

      modifiedTitlelineContent="${depth_markers} ${title} [${progress},${symbol},${modifyFlag}]"
      sed -i "${tgtLine}c ${modifiedTitlelineContent}" "${inputFile}"
    done

    bash "${0}" "${inputFile}" 'ta'
    exit 0

  }
}

: "æ·±ã•å–å¾—" && {
  ##############################################################################
  # æ·±ã•å–å¾—
  # å¯¾è±¡ãƒãƒ¼ãƒ‰ã®æ·±ã•ã‚’å–å¾—ã™ã‚‹
  # å¼•æ•°1:å¯¾è±¡ãƒãƒ¼ãƒ‰ç•ªå·
  # æ¨™æº–å‡ºåŠ›:å¯¾è±¡ãƒãƒ¼ãƒ‰ã®æ·±ã•
  ##############################################################################
  function getDepth {
    
    local selectNode="${1}"
    echo "${nodeDepths[$((selectNode-1))]}"

  }
}

: "ãƒãƒ¼ãƒ‰è¡Œç¯„å›²å–å¾—" && {
  ##############################################################################
  # è¡Œç•ªå·å–å¾—
  # ãƒãƒ¼ãƒ‰ç•ªå·ã‹ã‚‰ã€å¯¾è±¡ãƒãƒ¼ãƒ‰ã®é–‹å§‹è¡Œæ•°ã¨çµ‚äº†è¡Œæ•°ã‚’å–å¾—ã™ã‚‹
  # å¼•æ•°1:å¯¾è±¡ãƒãƒ¼ãƒ‰ç•ªå·
  # å¼•æ•°2:å‡ºåŠ›ã™ã‚‹è¡Œã®ç¨®é¡ã€€1:é–‹å§‹è¡Œç•ªå·ã‚’å‡ºåŠ›/9:çµ‚äº†è¡Œç•ªå·ã‚’å‡ºåŠ›
  # æ¨™æº–å‡ºåŠ›:å¼•æ•°2ãŒ1â€¦â€¦é–‹å§‹è¡Œç•ªå·
  #               2â€¦â€¦çµ‚äº†è¡Œç•ªå·
  #               ãªã—ã€ã‚‚ã—ãã¯ãã‚Œä»¥å¤–â€¦â€¦é–‹å§‹è¡Œç•ªå· çµ‚äº†è¡Œç•ªå·
  ##############################################################################
  function getLineNo {
    local selectNodeNo="${1}"
    local mode="${2}"
    local startLine="${nodeStartLines[$((selectNodeNo-1))]}"
    local endLine="${nodeEndLines[$((selectNodeNo-1))]}"

    case "${mode}" in
      '') echo "${startLine} ${endLine}" ;;
      1) echo  "${startLine}" ;;
      9) echo  "${endLine}" ;;
      *) echo  "${startLine} ${endLine}" ;;
    esac

  }
}

: "ã‚¿ã‚¤ãƒˆãƒ«å–å¾—ç³»" && {
  ##############################################################################
  # ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒˆãƒ«å–å¾—(ã‚¿ã‚¤ãƒˆãƒ«éƒ¨åˆ†ã®ã¿)
  # å¯¾è±¡ãƒãƒ¼ãƒ‰ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’å–å¾—ã™ã‚‹
  # å¼•æ•°1:å¯¾è±¡ãƒãƒ¼ãƒ‰ç•ªå·
  # æˆ»ã‚Šå€¤:ãªã—
  # æ¨™æº–å‡ºåŠ›:å¯¾è±¡ãƒãƒ¼ãƒ‰ã®ã‚¿ã‚¤ãƒˆãƒ«
  ##############################################################################
  function getNodeTitle {
    
    local selectNode="${1}"
    echo "${nodeTitles[$((selectNode-1))]}"

  }
  ##############################################################################
  # ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒˆãƒ«å–å¾—(ã‚¿ã‚¤ãƒˆãƒ«è¡Œå…¨ä½“)
  # å¯¾è±¡ãƒãƒ¼ãƒ‰ã®ã‚¿ã‚¤ãƒˆãƒ«è¡Œå…¨ä½“ã‚’å–å¾—ã™ã‚‹
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  # æˆ»ã‚Šå€¤:ãªã—
  # æ¨™æº–å‡ºåŠ›:å¯¾è±¡ãƒãƒ¼ãƒ‰ã®ã‚¿ã‚¤ãƒˆãƒ«è¡Œå…¨ä½“
  ##############################################################################
  function getNodeTitlelineContent {
    local selectNodeLineNo="${nodeStartLines[ $(( ${1}-1 )) ]}"
    echo "${fileLines[$((selectNodeLineNo-1))]}"
  }
}

: "ã‚°ãƒ«ãƒ¼ãƒ—ç¯„å›²å–å¾—ç³»" && {
  ##############################################################################
  # é¸æŠãƒãƒ¼ãƒ‰ã®æ‰€å±ã™ã‚‹ã‚°ãƒ«ãƒ¼ãƒ—ã®ç¯„å›²(ãƒãƒ¼ãƒ‰ç•ªå·)ã‚’å–å¾—ã™ã‚‹
  # å¼•æ•°1:å¯¾è±¡ãƒãƒ¼ãƒ‰ç•ªå·
  # å¼•æ•°2:å‡ºåŠ›ã™ã‚‹è¡Œã®ç¨®é¡ã€€1:é–‹å§‹è¡Œç•ªå·ã‚’å‡ºåŠ›/9:çµ‚äº†è¡Œç•ªå·ã‚’å‡ºåŠ›
  # æ¨™æº–å‡ºåŠ›:å¼•æ•°2ãŒ1â€¦â€¦é–‹å§‹è¡Œç•ªå·
  #               2â€¦â€¦çµ‚äº†è¡Œç•ªå·
  #               ãªã—ã€ã‚‚ã—ãã¯ãã‚Œä»¥å¤–â€¦â€¦é–‹å§‹è¡Œç•ªå· çµ‚äº†è¡Œç•ªå·
  ##############################################################################
  function getNodeNoInGroup {
    local selectNodeNo="${1}"
    local mode="${2}"
    local selectNoedDepth="$( getDepth ${selectNodeNo} )"

    startNodeSelectGroup="${selectNodeNo}"
    endNodeSelectGroup="${maxNodeCnt}"

    for i in $( seq "$(( ${selectNodeNo} + 1 ))" "${maxNodeCnt}") ;
    do
      depthCheck="$( getDepth ${i} )"
      if [[ ${depthCheck} -le ${selectNoedDepth} ]] ; then
        endNodeSelectGroup="$(( ${i} - 1 ))"
        break
      fi
    done

    case "${mode}" in
      '') echo "${startNodeSelectGroup} ${endNodeSelectGroup}" ;;
      1) echo  "${startNodeSelectGroup}" ;;
      9) echo  "${endNodeSelectGroup}" ;;
      *) echo  "${startNodeSelectGroup} ${endNodeSelectGroup}" ;;
    esac
  }

  ##############################################################################
  # é¸æŠãƒãƒ¼ãƒ‰ã®æ‰€å±ã™ã‚‹ã‚°ãƒ«ãƒ¼ãƒ—ã®ä¸€ã¤ä¸Š/ä¸‹ã®ã‚°ãƒ«ãƒ¼ãƒ—ã®ç¯„å›²(ãƒãƒ¼ãƒ‰ç•ªå·)ã‚’å–å¾—ã™ã‚‹
  # å¼•æ•°1:å¯¾è±¡ãƒãƒ¼ãƒ‰ç•ªå·
  # å¼•æ•°2:æ–¹å‘ã€€u:ä¸Š/d:ä¸‹
  # å¼•æ•°3:å‡ºåŠ›ã™ã‚‹è¡Œã®ç¨®é¡ã€€1:é–‹å§‹è¡Œç•ªå·ã‚’å‡ºåŠ›/9:çµ‚äº†è¡Œç•ªå·ã‚’å‡ºåŠ›
  # æˆ»ã‚Šå€¤:ï¼ˆã‚°ãƒ«ãƒ¼ãƒ—ãŒãªã„ã¨ãï¼‰e
  # æ¨™æº–å‡ºåŠ›:å¼•æ•°2ãŒ1â€¦â€¦é–‹å§‹è¡Œç•ªå·
  #               2â€¦â€¦çµ‚äº†è¡Œç•ªå·
  #               ãªã—ã€ã‚‚ã—ãã¯ãã‚Œä»¥å¤–â€¦â€¦é–‹å§‹è¡Œç•ªå· çµ‚äº†è¡Œç•ªå·
  ##############################################################################
  function getTargetNodeNoInGroup {
    local selectNodeNo="${1}"
    local direction="${2}"
    local mode="${3}"
    local selectNodeDepth="$( getDepth ${selectNodeNo} )"

    case "${direction}" in
      '')   local inc=1
            local goal="${maxNodeCnt}"
            ;;
      [uU]) local inc=-1
            local goal=1
            ;;
      [dD]) local inc=1
            local goal="${maxNodeCnt}"
            ;;
      *)    local inc=1
            local goal=1
            ;;
    esac

    for i in $( seq $(( "${selectNodeNo}" + "${inc}" )) "${inc}" "${goal}" ) ;
    do
      depth="$( getDepth ${i} )"
      if [[ ${depth} -le ${selectNodeDepth} ]] ; then
        returnNodeNo="${i}"
        break
      fi
    done

    if [[ ${depth} -ne ${selectNodeDepth} ]] ; then
      returnNodeNo=''
      exit 100
    fi

    local TargetGroupFromTo="$(getNodeNoInGroup ${returnNodeNo} '' )"
    local startnodeTargetGroup="$( echo ${TargetGroupFromTo} | cut -d ' ' -f 1 )"
    local endnodeTargetGroup="$(   echo ${TargetGroupFromTo} | cut -d ' ' -f 2 )"

    case "${mode}" in
      '') echo "${startnodeTargetGroup} ${endnodeTargetGroup}" ;;
      1) echo  "${startnodeTargetGroup}" ;;
      9) echo  "${endnodeTargetGroup}" ;;
      *) echo  "${startnodeTargetGroup} ${endnodeTargetGroup}" ;;
    esac
  }
}

: "é…ä¸‹ãƒãƒ¼ãƒ‰é–²è¦§ã‚³ãƒãƒ³ãƒ‰" && {
  ##############################################################################
  # é¸æŠãƒãƒ¼ãƒ‰ã‹ã‚‰ã€ä¸‹æ–¹å‘ã«é¸æŠãƒãƒ¼ãƒ‰ã‚ˆã‚Šã‚‚æ·±ã•ãŒæ·±ã„é™ã‚Šç¶šããƒãƒ¼ãƒ‰ç¯„å›²ã‚’å¯¾è±¡ã«ã€é–²è¦§ã™ã‚‹
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  ##############################################################################
  function groupView {

    local tgtGroup="$( getNodeNoInGroup ${indexNo} '' )"
    local startLineSelectGroup="$( getLineNo $( echo ${tgtGroup} | cut -d ' ' -f 1 ) 1 )"
    local endLineSelectGroup="$( getLineNo $( echo ${tgtGroup} | cut -d ' ' -f 2 ) 9 )"

    cat "${inputFile}" | sed -sn "${startLineSelectGroup},${endLineSelectGroup}p" > "${tmpfileTarget}"
    "${selected_viewer}" "${tmpfileTarget}"
    bash "${0}" "${inputFile}" 't'
    exit 0
  }
}

: "ç¯„å›²æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆè¡¨ç¤º" && {
  ##############################################################################
  # é–‹å§‹è¡Œæ•°ã‹ã‚‰æ•°é‡è¡Œæ•°ã¾ã§ã®ã€ç©ºè¡Œã¨ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒˆãƒ«è¡Œã‚’é™¤å¤–ã—ãŸæ–‡å­—æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹
  # å¼•æ•°1:é–‹å§‹è¡Œæ•°
  # å¼•æ•°2:çµ‚äº†è¡Œæ•°
  # æˆ»ã‚Šå€¤:ãªã—
  # æ¨™æº–å‡ºåŠ›:æ–‡å­—æ•°
  ##############################################################################
  function groupCharCount {

    local lineStart="${1}"
    local lineEnd="${2}"
    
    local contentLines=""
    for ((lineNum=lineStart; lineNum<=lineEnd; lineNum++)); do
      local line="${fileLines[$((lineNum-1))]}"
      if [[ ! "${line}" =~ ^#.+ ]] ; then
        contentLines+="${line}"
      fi
    done
    echo "${#contentLines}"

  }
  
  ##############################################################################
  # é¸æŠãƒãƒ¼ãƒ‰ã‹ã‚‰ã€ä¸‹æ–¹å‘ã«é¸æŠãƒãƒ¼ãƒ‰ã‚ˆã‚Šã‚‚æ·±ã•ãŒæ·±ã„é™ã‚Šç¶šããƒãƒ¼ãƒ‰ç¯„å›²ã‚’å¯¾è±¡ã«ã€æ–‡å­—æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã—ã¦è¡¨ç¤ºã™ã‚‹ã€‚
  # ç©ºè¡Œã¨ã€ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒˆãƒ«è¡Œã¯é™¤å¤–ã™ã‚‹ã€‚
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  # æ¨™æº–å‡ºåŠ›:æ–‡å­—æ•°è¡¨ç¤º(ã‚¢ãƒŠã‚¦ãƒ³ã‚¹)
  ##############################################################################
  function dispGroupCharCount {

    local tgtGroupStart="$( getLineNo $( getNodeNoInGroup ${indexNo} 1 ) 1 )"
    local tgtGroupEnd="$( getLineNo $( getNodeNoInGroup ${indexNo} 9 ) 9 )"

    count="$( groupCharCount ${tgtGroupStart} ${tgtGroupEnd} )"

    printf "ãƒãƒ¼ãƒ‰ç•ªå·%dã®é…ä¸‹ã®æ–‡å­—æ•°åˆè¨ˆ : %d\n" "${indexNo}" "${count}"
    printf "â€» %dè¡Œç›®ã‹ã‚‰%dè¡Œç›®ã€‚ç©ºè¡Œã¨ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒˆãƒ«è¡Œã®æ–‡å­—å«ã¾ãšã€‚\n" "${tgtGroupStart}" "${tgtGroupEnd}"
  }
}

: "ãƒ„ãƒªãƒ¼è¡¨ç¤ºç³»" && {
  ##############################################################################
  # ãƒ„ãƒªãƒ¼è¡¨ç¤ºã™ã‚‹
  # t:é€šå¸¸ãƒ„ãƒªãƒ¼
  # tl:é–‹å§‹è¡Œç•ªå·ä»˜ããƒ„ãƒªãƒ¼è¡¨ç¤º
  # ta:é–‹å§‹çµ‚äº†è¡Œç•ªå·æ·±ã•ä»˜ããƒ„ãƒªãƒ¼è¡¨ç¤º
  # å…ˆé ­ã‹ã‚‰æœ«å°¾ã‚’æŒ‡å®šã—ã¦ãƒ„ãƒªãƒ¼ãƒ“ãƒ¥ãƒ¼ã‚’å‘¼ã³å‡ºã™ãƒ©ãƒƒãƒ‘ãƒ¼
  ##############################################################################
  function displayTree {
    local indexNoToOption="${indexNo}"
    local indexNo=''
    tree 1 "${maxNodeCnt}" "${indexNoToOption}" "${allCharCount}"
  }

  ##############################################################################
  # å¯¾è±¡ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ãƒ•ã‚©ãƒ¼ã‚«ã‚¹è¡¨ç¤ºã™ã‚‹
  # f:é€šå¸¸ãƒ•ã‚©ãƒ¼ã‚«ã‚¹è¡¨ç¤º
  # fl:é–‹å§‹è¡Œç•ªå·ä»˜ããƒ•ã‚©ãƒ¼ã‚«ã‚¹è¡¨ç¤º
  # fa:é–‹å§‹çµ‚äº†è¡Œç•ªå·æ·±ã•ä»˜ããƒ•ã‚©ãƒ¼ã‚«ã‚¹è¡¨ç¤º
  # ã‚°ãƒ«ãƒ¼ãƒ—(é–‹å§‹ãƒãƒ¼ãƒ‰ã¨çµ‚äº†ãƒãƒ¼ãƒ‰)ã‚’æŒ‡å®šã—ã¦ãƒ„ãƒªãƒ¼ãƒ“ãƒ¥ãƒ¼ã‚’å‘¼ã³å‡ºã™ãƒ©ãƒƒãƒ‘ãƒ¼
  ##############################################################################
  function focusMode {

    local SelectGroupNodeFromTo="$(getNodeNoInGroup ${indexNo} '' )"
    local startNodeSelectGroup="$( echo ${SelectGroupNodeFromTo} | cut -d ' ' -f 1 )"
    local endNodeSelectGroup="$( echo ${SelectGroupNodeFromTo} | cut -d ' ' -f 2 )"
    local focusCount="$( groupCharCount $( getLineNo ${startNodeSelectGroup} 1 ) $( getLineNo ${endNodeSelectGroup} 9 ) )"
    
    tree "${startNodeSelectGroup}" "${endNodeSelectGroup}" "${option}" "${focusCount}"

  }

  ##############################################################################
  # ãƒ„ãƒªãƒ¼è¡¨ç¤ºã™ã‚‹
  # t:é€šå¸¸ãƒ„ãƒªãƒ¼
  # tl:é–‹å§‹è¡Œç•ªå·ä»˜ããƒ„ãƒªãƒ¼è¡¨ç¤º
  # ta:é–‹å§‹çµ‚äº†è¡Œç•ªå·æ·±ã•ä»˜ããƒ„ãƒªãƒ¼è¡¨ç¤º
  # å¼•æ•°1: hiddenãƒ•ãƒ©ã‚°ã®æœ‰åŠ¹ç„¡åŠ¹(h:æœ‰åŠ¹/ä»–:ç„¡åŠ¹)
  ##############################################################################
  function tree {
    local startNodeSelectGroup="${1}"
    local endNodeSelectGroup="${2}"
    local hiddenOption="${3}"
    local allCharCount="${4}"

    printf "ã€$(basename ${inputFile})ã€‘åˆè¨ˆ${allCharCount}æ–‡å­—"
    
    case "${char1}" in
      't')  echo '';;
      'f')  echo " â˜… ãƒ•ã‚©ãƒ¼ã‚«ã‚¹è¡¨ç¤ºä¸­";;
      *)    echo '';;
    esac
    case "${char2}" in
      '') echo 'ç¯€   æ¸ˆ ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³'
          echo '====+==+============'
          ;;
      'l')  echo 'ç¯€   è¡Œç•ªå·   å­—æ•°   æ¸ˆ ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³'
            echo '====+========+======+==+============'
            ;;
      'a')  echo 'ç¯€   è¡Œç•ªå·            æ·±  å­—æ•°   æ¸ˆ è¦– ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³'
            echo '====+========+========+===+======+==+==+============'
            ;;
      *)    ;;
    esac

    seq "${startNodeSelectGroup}" "${endNodeSelectGroup}" | {
      while read -r cnt ; do
        startLine="$( getLineNo ${cnt} 1 )"
        endLine="$(   getLineNo ${cnt} 9 )"
        depth="$( getDepth ${cnt} )"

        count="${nodeCharCount[$((cnt-1))]}"
        progress="${nodeProgress[$((cnt-1))]:=0}"
        hideFlag="${nodeHideFlags[$((cnt-1))]:=0}"

        if [[ "${hideFlag}" = '1' ]] && [[ "${hiddenOption}" = 'h' ]]; then
          continue
        fi

        if [[ ${progress} -eq 1 ]] ; then
          progress='â˜‘ï¸ '
        else
          progress='â¬œï¸'
        fi

        if [[ "${hideFlag}" = '1' ]] ; then
          hideFlag='ğŸ•¶ï¸ '
        else
          hideFlag='  '
        fi

        symbols="${nodeSymbols[$((cnt-1))]}"

        printf "%4d" "${cnt}"

        case "${char2}" in
          '')  printf " %s" "${progress}"
                ;;
          'l') printf " %8d %6d %s" "${startLine}" "${count}" "${progress}"
                ;;
          'a') printf " %8d~%8d %3d %6d %s %s" "${startLine}" "${endLine}" "${depth}" "${count}" "${progress}" "${hideFlag}"
                ;;
          *)    ;;
        esac

        seq ${depth} | while read -r line; do printf ' '; done
        
        case "${depth}" in
          '1') printf 'ğŸ“šï¸ '
              ;;
          '2') printf 'â””ğŸ“— '
              ;;
          [34]) printf 'â””ğŸ“– '
                ;;
          [567]) printf 'â””ğŸ“„ '
                ;;
          [89]) printf 'â””ğŸ·ï¸ '
                ;;
          '10')  printf 'â””ğŸ—¨ï¸ '
                ;;        
          *) printf 'â””ğŸ—¨ï¸ '
            ;;
        esac 

        printf "%s " "${symbols}"

        echo "$( getNodeTitle ${cnt} )"

      done

    }

    echo 'â“ï¸å¼•æ•°ãªã—ã§helpå‚ç…§'
    exit 0
   
  }
}

: "ãƒãƒ¼ãƒ‰å‡ºåŠ›ç³»ã‚³ãƒãƒ³ãƒ‰" && {
  ##############################################################################
  # é…ä¸‹ãƒãƒ¼ãƒ‰ã‚’å«ã‚“ã ç¯„å›²ã‚’åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›ã™ã‚‹
  # å¼•æ•°1: å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹(ãƒ•ã‚¡ã‚¤ãƒ«åå«)
  # ãƒãƒ¼ãƒ‰æŒ‡å®šã¨å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‹ã‚‰å–å¾—
  ##############################################################################
  function outputGroup {

    local outputFile="${1}"


    if [[ -z "${outputFile/ /}" ]] ; then
      local nodeTitles="${nodeTitles[$((${indexNo}-1))]}"
      outputFile="./${nodeTitles}.txt"
      echo "å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«åã®æŒ‡å®šãŒãªã‹ã£ãŸãŸã‚ã€ãƒãƒ¼ãƒ‰åã‚’ä½¿ç”¨ã—ã¾ã™ã€‚"
    fi

    if [[ -f "${outputFile}" ]] ; then
      printf "å‡ºåŠ›å…ˆã«æ—¢ã«åŒåã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã¾ã™ã€‚ä¸Šæ›¸ãã—ã¾ã™ã‹ï¼Ÿ (y/n)\n>"
      read yn
      if [[ "${yn}" != 'y' ]] ; then
        echo "å‡ºåŠ›ã‚’ä¸­æ­¢ã—ã¾ã—ãŸã€‚"
        exit 0
      fi
    fi

    local selectGroupFromTo="$( getNodeNoInGroup ${indexNo} '' )"
    local startLineSelectGroup="$( getLineNo $( echo ${selectGroupFromTo} | cut -d ' ' -f 1 ) 1 )"
    local endLineSelectGroup="$( getLineNo $( echo ${selectGroupFromTo} | cut -d ' ' -f 2 ) 9 )"

      cat "${inputFile}" \
    | sed -n "${startLineSelectGroup},${endLineSelectGroup}p" \
    | sed '/^\/\//d' \
    > "${outputFile}"
    
    echo "ãƒãƒ¼ãƒ‰ç¯„å›²ã‚’å‡ºåŠ›ã—ã¾ã—ãŸ: ${outputFile}"
    exit 0
  }
}

: "ãƒãƒ¼ãƒ‰å‰Šé™¤ãƒ»ãƒãƒ¼ãƒ‰ç·¨é›†ãƒ»å˜ä¸€ãƒãƒ¼ãƒ‰é–²è¦§ã‚³ãƒãƒ³ãƒ‰" && {
  ##############################################################################
  # d:å¯¾è±¡ã®ãƒãƒ¼ãƒ‰ã‚’å‰Šé™¤ã™ã‚‹
  # e:å¯¾è±¡ã®ãƒãƒ¼ãƒ‰ã‚’ç·¨é›†ã™ã‚‹
  # v:å¯¾è±¡ã®ãƒãƒ¼ãƒ‰ã‚’é–²è¦§ã™ã‚‹
  ##############################################################################
  function singleNodeOperations {

    selectNodeLineFromTo="$( getLineNo ${indexNo} '' )"
    local selectNodeArray=($selectNodeLineFromTo)
    startLineSelectNode="${selectNodeArray[0]}"
    endLineSelectNode="${selectNodeArray[1]}"

    endLineHeader="$(( ${startLineSelectNode} -1 ))"
    startLineFooter="$(( ${endLineSelectNode} +1 ))"

    (
      if [[ ${indexNo} -eq 1 ]]; then
        printf '' > "${tmpfileHeader}"
      else
        cat "${inputFile}" | { head -n "${endLineHeader}" > "${tmpfileHeader}"; cat >/dev/null;}
      fi
      wait
    )
    (
      if [[ ${indexNo} -eq 1 ]] ; then
        cat "${inputFile}" | { sed -n "1, ${endLineSelectNode}p" > "${tmpfileSelect}"; cat >/dev/null;}
      else
        if [[ ${indexNo} -eq ${maxNodeCnt} ]] ; then
          cat "${inputFile}" | { tail -n +${startLineSelectNode}  > "${tmpfileSelect}"; cat >/dev/null;}
        else
          cat "${inputFile}" | { sed -n "${startLineSelectNode},${endLineSelectNode}p" > "${tmpfileSelect}"; cat >/dev/null;}
        fi
      fi
      wait
    )
    (
      if [[ ${indexNo} -eq ${maxNodeCnt} ]] ; then
        printf '' > "${tmpfileFooter}"
      else
        tail -n +"${startLineFooter}" "${inputFile}" > "${tmpfileFooter}"
      fi
      wait
    )

    case "${action}" in
      'e')  "${selected_editor}" "${tmpfileSelect}"
            wait
            sed -i -e '$a\' "${tmpfileSelect}" #ç·¨é›†ã®çµæœæœ«å°¾ã«æ”¹è¡ŒãŒãªã„å ´åˆ'
            cat "${tmpfileHeader}" "${tmpfileSelect}" "${tmpfileFooter}" > "${inputFile}"
            ;;
      'd')  cat "${tmpfileHeader}" "${tmpfileFooter}" > "${inputFile}"
            ;;
      'v')  "${selected_viewer}" "${tmpfileSelect}"
            ;;
      *)    echo 'ä¸æ­£ãªå¼•æ•°ã§ã™ã€‚'
            exit 9
            ;;
    esac

    bash "${0}" "${inputFile}" 't'
    exit 0
  }
}

: "ãƒãƒ¼ãƒ‰æŒ¿å…¥ã‚³ãƒãƒ³ãƒ‰" && {
  ##############################################################################
  # å¯¾è±¡ã®ãƒãƒ¼ãƒ‰ã®ä¸‹ã«æ–°ã—ã„ãƒãƒ¼ãƒ‰ã‚’æŒ¿å…¥ã™ã‚‹
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  ##############################################################################
  function insert {
    nlString="${option:-åç§°æœªè¨­å®š}"
    endLinePreviousNode="$( getLineNo ${indexNo} 9 )"
    startLineNextNode="$(   getLineNo $(( ${indexNo} +1 )) 1 )"

    depth="$( getDepth ${indexNo} )"
    dots="$(seq ${depth} | while read -r line; do printf '#'; done)"

    echo -e "${dots} ${nlString} [,,]" > "${tmpfileSelect}"
    cat "${inputFile}" | { head -n "${endLinePreviousNode}" > "${tmpfileHeader}"; cat >/dev/null;}

    if [[ ${indexNo} -eq ${maxNodeCnt} ]] ;then
      awk 1 "${inputFile}" "${tmpfileSelect}" > "${tmpfile1}"
      cat "${tmpfile1}" > "${inputFile}"

    else
      cat "${inputFile}" | { tail -n +${startLineNextNode}  > "${tmpfileFooter}"; cat >/dev/null;}
      cat "${tmpfileHeader}" "${tmpfileSelect}" "${tmpfileFooter}" > "${inputFile}"
    fi
  }

  ##############################################################################
  # å¯¾è±¡ã®ãƒãƒ¼ãƒ‰ã®ä¸‹ã«æ–°ã—ã„ãƒãƒ¼ãƒ‰ã‚’æŒ¿å…¥ã™ã‚‹
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  ##############################################################################
  function insertEdit {
    insert
    bash "${0}" "${inputFile}" 'e' "$((${indexNo} + 1))"
    exit 0
  }

  ##############################################################################
  # å¯¾è±¡ã®ãƒãƒ¼ãƒ‰ã®ä¸‹ã«æ–°ã—ã„ãƒãƒ¼ãƒ‰ã‚’æŒ¿å…¥ã™ã‚‹
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  ##############################################################################
  function insertNode {    
    insert
    bash "${0}" "${inputFile}" 't'
    exit 0
  }
}

: "å˜ãƒãƒ¼ãƒ‰æ·±ã•å¤‰æ›´ã‚³ãƒãƒ³ãƒ‰" && {
  ##############################################################################
  # å¯¾è±¡ã®ãƒãƒ¼ãƒ‰ä¸€ã¤ã ã‘ã®æ·±ã•ã‚’å¤‰æ›´ã™ã‚‹
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  ##############################################################################
  function slideNode {

    tgtLine="$(getLineNo ${indexNo} 1 )"

    case "${char2}" in
      'l')  sed -i -e "$tgtLine s/^##/#/g" "${inputFile}"
            ;;
      'r')  sed -i -e "$tgtLine s/^/#/g" "${inputFile}"
            ;;
      *)    echo 'err'
            exit 9
            ;;
    esac

    bash "${0}" "${inputFile}" 'ta'
    exit 0

  }
}

: "å˜ãƒãƒ¼ãƒ‰ä¸Šä¸‹äº¤æ›ã‚³ãƒãƒ³ãƒ‰" && {
  ##############################################################################
  # å¯¾è±¡ã®ãƒãƒ¼ãƒ‰ä¸€ã¤ã ã‘ã‚’ä¸Šä¸‹ã«ç§»å‹•ã™ã‚‹(æŒ‡å®šã®æ–¹å‘ã®ãƒãƒ¼ãƒ‰ã¨å…¥ã‚Œæ›¿ãˆã‚‹)
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  ##############################################################################
  function swapNode {

    local indexTargetNode=''
    local indexNextNode=''
    local endLinePreviousNode=''
    local startLineTargetNode=''
    local endLineTargetNode=''
    local targetNodeLineFromTo=''

    local indexSelectNode="$(( ${indexNo} ))"
    local selectNodeLineFromTo="$( getLineNo ${indexSelectNode} '' )"
    local selectNodeArray=($selectNodeLineFromTo)
    local startLineSelectNode="${selectNodeArray[0]}"
    local endLineSelectNode="${selectNodeArray[1]}"

    case "${char2}" in
      'u')  indexTargetNode="$(( ${indexNo} -1 ))"
            #indexSelectNode="$(( ${indexNo}    ))"
            indexNextNode="$((   ${indexNo} +1 ))"

            endLinePreviousNode="$(( $( getLineNo ${indexTargetNode} 1 ) - 1 ))"

            targetNodeLineFromTo="$( getLineNo ${indexTargetNode} '' )"
            local targetNodeArray=($targetNodeLineFromTo)
            startLineTargetNode="${targetNodeArray[0]}"
            endLineTargetNode="${targetNodeArray[1]}"

            if [[ ${indexNo} -eq ${maxNodeCnt} ]] ; then
              startLineNextNode=''
            else
              startLineNextNode="$( getLineNo ${indexNextNode} 1 )"
            fi
            
            (
              cat "${inputFile}" | { head -n "${endLinePreviousNode}" > "${tmpfileHeader}"; cat >/dev/null;}
              cat "${inputFile}" | { sed -sn "${startLineTargetNode},${endLineTargetNode}p" > "${tmpfileTarget}"; cat >/dev/null;}
              cat "${inputFile}" | { sed -sn "${startLineSelectNode},${endLineSelectNode}p" > "${tmpfileSelect}"; cat >/dev/null;}
              if [[ ! "${startLineNextNode}" = '' ]] ; then 
                tail -n +"${startLineNextNode}" "${inputFile}" > "${tmpfileFooter}"
              fi
              wait
            )
            (
              cat "${tmpfileHeader}" "${tmpfileSelect}" > "${tmpfile1}"
              cat "${tmpfileTarget}" "${tmpfileFooter}" > "${tmpfile2}"
              wait
            )
            cat "${tmpfile1}" "${tmpfile2}" > "${inputFile}"

            ;;

      'd')  indexPreviousNode="$(( ${indexNo} -1 ))"
            #indexSelectNode="$((   ${indexNo}    ))"
            indexTargetNode="$((   ${indexNo} +1 ))"
            indexNextNode="$((     ${indexNo} +2 ))"
            
            endLinePreviousNode="$( getLineNo ${indexPreviousNode} 9 )"

            targetNodeLineFromTo="$( getLineNo ${indexTargetNode} '' )"
            local targetNodeArray=($targetNodeLineFromTo)
            startLineTargetNode="${targetNodeArray[0]}"

            if [[ ${indexNo} -eq ${maxNodeCnt} ]] ; then
              endLineTargetNode="${#fileLines[@]}"
            else
              endLineTargetNode="${targetNodeArray[1]}"
              startLineNextNode="$( getLineNo ${indexNextNode}   1 )"
            fi
            (
              if [[ ${indexNo} -eq 1 ]] ; then
                echo '' > "${tmpfileHeader}"
              else
                cat "${inputFile}" | { head -n "${endLinePreviousNode}" > "${tmpfileHeader}"; cat >/dev/null;}
              fi
              cat "${inputFile}" | { sed -sn "${startLineTargetNode},${endLineTargetNode}p" > "${tmpfileTarget}"; cat >/dev/null;} 
              cat "${inputFile}" | { sed -sn "${startLineSelectNode},${endLineSelectNode}p" > "${tmpfileSelect}"; cat >/dev/null;}
              if [[ ! ${startLineNextNode} = '' ]] ; then 
                tail -n +"${startLineNextNode}" "${inputFile}" > "${tmpfileFooter}"
              fi
              wait
            )
            (
              cat "${tmpfileHeader}" "${tmpfileTarget}" > "${tmpfile1}"
              cat "${tmpfileSelect}" "${tmpfileFooter}" > "${tmpfile2}"
              wait
            )
            cat "${tmpfile1}" "${tmpfile2}" > "${inputFile}"
            ;;

      *)    echo 'err'
            exit 9
            ;;
    esac

    bash "${0}" "${inputFile}" 't'
    exit 0
  }
}

: "é…ä¸‹ãƒãƒ¼ãƒ‰æ·±ã•å¤‰æ›´ã‚³ãƒãƒ³ãƒ‰" && {
  ##############################################################################
  # å¯¾è±¡ã®ãƒãƒ¼ãƒ‰ã¨ãã®é…ä¸‹ã®æ·±ã•ã‚’ã€ä¸€ç·’ã«å¤‰æ›´ã™ã‚‹
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  ##############################################################################
  function slideGroup {

    local SelectGroupNodeFromTo="$( getNodeNoInGroup ${indexNo} '' )"
    local selectGroupArray=($SelectGroupNodeFromTo)
    local startNodeSelectGroup="${selectGroupArray[0]}"
    local endNodeSelectGroup="${selectGroupArray[1]}"

    case "${char3}" in
      'l')  for i in $(seq "${startNodeSelectGroup}" "${endNodeSelectGroup}") ;
            do
              tgtLine="$( getLineNo ${i} 1 )"
              sed -i -e "${tgtLine} s/^##/#/g" "${inputFile}"
            done
            ;;
      'r')  for i in $(seq "${startNodeSelectGroup}" "${endNodeSelectGroup}") ;
            do
              tgtLine="$( getLineNo ${i} 1 )"
              sed -i -e "${tgtLine} s/^#/##/g" "${inputFile}"
            done
            ;;
      *)    echo 'err'
            read -s -n 1 c
            exit 9
            ;;
    esac

    bash "${0}" "${inputFile}" 'ta'
    exit 0

  }
}

: "é…ä¸‹ãƒãƒ¼ãƒ‰ä¸Šä¸‹äº¤æ›ã‚³ãƒãƒ³ãƒ‰" && {
  ##############################################################################
  # å¯¾è±¡ã®ãƒãƒ¼ãƒ‰ã¨ãã®é…ä¸‹ã¨ã€å¯¾è±¡ãƒãƒ¼ãƒ‰ã¨åŒã˜é«˜ã•ã®ä¸Šä¸‹ãƒãƒ¼ãƒ‰ã¨ãã®é…ä¸‹ã¨ã‚’ã€åŒæ™‚ã«å…¥ã‚Œæ›¿ãˆã‚‹
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  ##############################################################################
  function swapGroup {

    local selectNodeDepth=0
    local depthCheck=0
    local direction="${char3}"

    local selectNodeLineFromTo=''
    local startLineSelectGroup=''
    local endLineSelectGroup=''

    local targetNodeLineFromTo=''
    local startLineTargetGroup=''
    local endLineTargetGroup=''

    : "é¸æŠã‚°ãƒ«ãƒ¼ãƒ—æƒ…å ±ã‚’å–å¾—" && {
      selectNodeLineFromTo="$( getNodeNoInGroup ${indexNo} '' )"
      local selectNodeArray=($selectNodeLineFromTo)
      startLineSelectGroup="$(getLineNo ${selectNodeArray[0]} 1 )"
      endLineSelectGroup="$(  getLineNo ${selectNodeArray[1]} 9 )"

    }

    : "ç§»å‹•å…ˆã‚°ãƒ«ãƒ¼ãƒ—æƒ…å ±ã‚’å–å¾—" && {
      #ä¸Šç§»å‹•ã®å ´åˆ
      ##ã‹ã¤å¯¾è±¡ãƒãƒ¼ãƒ‰ãŒä¸€ç•ªä¸Šã®å ´åˆ
      targetNodeLineFromTo="$(getTargetNodeNoInGroup "${indexNo}" "${direction}" '' )" 
      if [[ "${?}" -ne 0 ]] ; then
        echo 'äº¤æ›ç§»å‹•å¯èƒ½ãªã‚°ãƒ«ãƒ¼ãƒ—ãŒã‚ã‚Šã¾ã›ã‚“'
        read -s -n 1 c
        bash "${0}" "${inputFile}" 't'
        exit 0
      else
        local targetNodeArray=($targetNodeLineFromTo)
        startLineTargetGroup="$(getLineNo ${targetNodeArray[0]} 1 )"
        endLineTargetGroup="$(  getLineNo ${targetNodeArray[1]} 9 )"
      fi
    }

    : "ãƒ˜ãƒƒãƒ€éƒ¨åˆ†ã®æƒ…å ±ã‚’å–å¾—" && {
      # directionãŒu(ä¸Šã¨äº¤æ›)ã®å ´åˆ:1è¡Œç›®ã€œã€Œç§»å‹•å…ˆã‚°ãƒ«ãƒ¼ãƒ—ã®å…ˆé ­ãƒãƒ¼ãƒ‰ã®å…ˆé ­è¡Œã®ï¼‘è¡Œå‰(startLineTargetGroup-1)ã€
      # directionãŒd(ä¸‹ã¨äº¤æ›)ã®å ´åˆ:1è¡Œç›®ã€œã€Œé¸æŠã‚°ãƒ«ãƒ¼ãƒ—ã®å…ˆé ­ãƒãƒ¼ãƒ‰ã®å…ˆé ­è¡Œã®1è¡Œå‰(startLineSelectGroup-1)
      
      if [[ ${startLineTargetGroup} -eq 1 ]] ; then
        startLineHeaderGroup=0
        endLineHeaderGroup=0
      else
        startLineHeaderGroup=1
        case "${direction}" in
          [uU]) endLineHeaderGroup="$(( ${startLineTargetGroup} -1 ))"
                ;;
          [dD]) endLineHeaderGroup="$(( ${startLineSelectGroup} -1 ))"
                ;;
          *)  echo 'err'
              ;;
        esac
      fi
    }

    : "ãƒ•ãƒƒã‚¿éƒ¨åˆ†ã®æƒ…å ±ã‚’å–å¾—" && {
      # directionãŒu(ä¸Šã¨äº¤æ›)ã®å ´åˆ:ã€Œé¸æŠã‚°ãƒ«ãƒ¼ãƒ—ã®æœ«å°¾ãƒãƒ¼ãƒ‰ã®æœ«å°¾è¡Œã®1è¡Œå¾Œã‚(endLineSelectGroup+1)ã€ã€œæœ€çµ‚è¡Œ
      # directionãŒd(ä¸‹ã¨äº¤æ›)ã®å ´åˆ:ã€Œç§»å‹•å…ˆã‚°ãƒ«ãƒ¼ãƒ—ã®æœ«å°¾ãƒãƒ¼ãƒ‰ã®æœ«å°¾è¡Œã®1è¡Œå¾Œã‚(endLineTargetGroup+1)ã€ã€œæœ€çµ‚è¡Œ

      if [[ ${endLineTargetGroup} -eq ${maxLineCnt} ]] ; then
        startLineFooterGroup="${maxLineCnt}"
        endLineFooterGroup="${maxLineCnt}"
      else
        case "${direction}" in
          [uU]) startLineFooterGroup="$(( ${endLineSelectGroup} +1 ))"
                ;;
          [dD]) startLineFooterGroup="$(( ${endLineTargetGroup} +1 ))"
                ;;
          *)  echo 'err'
              exit 9
              ;;
        esac
        endLineFooterGroup="${maxLineCnt}"
      fi
    }

   if [[ ${endLineHeaderGroup} -ne 0 ]] ; then
     cat "${inputFile}" | { head -n "${endLineHeaderGroup}" > "${tmpfileHeader}"; cat >/dev/null;}
    else
      printf '' > "${tmpfileHeader}"
    fi

    cat "${inputFile}" | { sed -sn "${startLineTargetGroup},${endLineTargetGroup}p" > "${tmpfileTarget}"; cat >/dev/null;} 
    cat "${inputFile}" | { sed -sn "${startLineSelectGroup},${endLineSelectGroup}p" > "${tmpfileSelect}"; cat >/dev/null;}

    if [[ ${startLineFooterGroup} -ne ${maxLineCnt} ]] ; then
      tail -n +"${startLineFooterGroup}" "${inputFile}" > "${tmpfileFooter}"
    else
      printf '' > "${tmpfileFooter}"
    fi

    (
      case "${direction}" in
        [uU]) cat "${tmpfileHeader}" "${tmpfileSelect}" > "${tmpfile1}"
              cat "${tmpfileTarget}" "${tmpfileFooter}" > "${tmpfile2}"
              ;;
        [dD]) cat "${tmpfileHeader}" "${tmpfileTarget}" > "${tmpfile1}"
              cat "${tmpfileSelect}" "${tmpfileFooter}" > "${tmpfile2}"
              ;;
        *)    echo 'err'
              read -s -n 1 c
              exit 9
              ;;
      esac
      wait
    )

    cat "${tmpfile1}" "${tmpfile2}" > "${inputFile}"
    bash "${0}" "${inputFile}" 't'
    exit 0

  }
}

: "é…ä¸‹ãƒãƒ¼ãƒ‰å‰Šé™¤ã‚³ãƒãƒ³ãƒ‰" && {
  ##############################################################################
  # å¯¾è±¡ã®ãƒãƒ¼ãƒ‰ã¨ãã®é…ä¸‹ã‚’å‰Šé™¤ã™ã‚‹
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  ##############################################################################
  function deleteGroup {

    local selectGroupNodeFromTo="$( getNodeNoInGroup ${indexNo} '' )"
    local startNodeSelectGroup="$( echo ${selectGroupNodeFromTo} | cut -d ' ' -f 1 )"
    local endNodeSelectGroup="$(   echo ${selectGroupNodeFromTo} | cut -d ' ' -f 2 )"

    local startLineSelectGroup="$( getLineNo ${startNodeSelectGroup} 1 )"
    local endLineSelectGroup="$(   getLineNo ${endNodeSelectGroup} 9 )"

    local endLineHeader="$(( ${startLineSelectGroup} - 1 ))"
    local startLineFooter="$(( ${endLineSelectGroup} + 1 ))"

    (
      if [[ ${endLineHeader} -eq 0 ]]; then
        printf '' > "${tmpfileHeader}"
      else
        cat "${inputFile}" | { head -n "${endLineHeader}" > "${tmpfileHeader}"; cat >/dev/null;}
      fi
      wait
    )
    (
      if [[ ${startLineFooter} -gt ${maxLineCnt} ]] ; then
        printf '' > "${tmpfileFooter}"
      else
        tail -n +"${startLineFooter}" "${inputFile}" > "${tmpfileFooter}"
      fi
      wait
    )

    cat "${tmpfileHeader}" "${tmpfileFooter}" > "${inputFile}"

    bash "${0}" "${inputFile}" 't'
    exit 0
  }
}

: "ãƒãƒ¼ãƒ‰çµåˆ" && {
  ##############################################################################
  # ãƒãƒ¼ãƒ‰çµåˆ
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  # æŒ‡å®šã®ãƒãƒ¼ãƒ‰ã«ã€æŒ‡å®šã®ãƒãƒ¼ãƒ‰ã®ã²ã¨ã¤ä¸‹ã®ãƒãƒ¼ãƒ‰ã‚’çµåˆã™ã‚‹ã€‚
  ##############################################################################
  function joinNode {

    local tgtLine="$( echo ${nodeStartLines[${indexNo}]} )"
    sed -i "${tgtLine}d" "${inputFile}"
    bash "${0}" "${inputFile}" 't'
    exit 0
  }

  ##############################################################################
  # é…ä¸‹ãƒãƒ¼ãƒ‰çµåˆ
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  # æŒ‡å®šã®ãƒãƒ¼ãƒ‰ã«ã€æŒ‡å®šã®ãƒãƒ¼ãƒ‰é…ä¸‹ã®ãƒãƒ¼ãƒ‰ã™ã¹ã¦ã‚’çµåˆã™ã‚‹
  ##############################################################################
  function joinGroup {

    local selectGroupNodeFromTo="$( getNodeNoInGroup ${indexNo} '' )"
    local startNodeSelectGroup="$( echo ${selectGroupNodeFromTo} | cut -d ' ' -f 1 )"
    local endNodeSelectGroup="$(   echo ${selectGroupNodeFromTo} | cut -d ' ' -f 2 )"

    local startLineSelectGroup="$( getLineNo ${startNodeSelectGroup} 1 )"
    local endLineSelectGroup="$(   getLineNo ${endNodeSelectGroup} 9 )"

    local endLineHeader="$(( ${startLineSelectGroup} - 1 ))"
    local startLineFooter="$(( ${endLineSelectGroup} + 1 ))"

    (
      if [[ ${indexNo} -eq 1 ]]; then
        printf '' > "${tmpfileHeader}"
      else
        cat "${inputFile}" | { head -n "${endLineHeader}" > "${tmpfileHeader}"; cat >/dev/null;}
      fi
      wait
    )
    (
      if [[ ${indexNo} -eq 1 ]] ; then
        cat "${inputFile}" | { sed -n "1, ${endLineSelectGroup}p" > "${tmpfileSelect}"; cat >/dev/null;}
      else
        if [[ ${indexNo} -eq ${maxNodeCnt} ]] ; then
          cat "${inputFile}" | { tail -n +${startLineSelectGroup}  > "${tmpfileSelect}"; cat >/dev/null;}
        else
          cat "${inputFile}" | { sed -n "${startLineSelectGroup},${endLineSelectGroup}p" > "${tmpfileSelect}"; cat >/dev/null;}
        fi
      fi
      wait
    )
    (
      if [[ ${indexNo} -eq ${maxNodeCnt} ]] ; then
        printf '' > "${tmpfileFooter}"
      else
        tail -n +"${startLineFooter}" "${inputFile}" > "${tmpfileFooter}"
      fi
      wait
    )

    local titleLine="$(cat ${tmpfileSelect} | head -n 1)"
    local content="$(tail -n +2 ${tmpfileSelect} | sed -E 's/^#+\s.+\[.+\]//g')"

    echo -e "${titleLine}\n${content}" > "${tmpfileSelect}"
    sed -i -e '$a\' "${tmpfileSelect}" #ç·¨é›†ã®çµæœæœ«å°¾ã«æ”¹è¡ŒãŒãªã„å ´åˆ'
    
    cat "${tmpfileHeader}" "${tmpfileSelect}" "${tmpfileFooter}" > "${inputFile}"

    bash "${0}" "${inputFile}" 't'
    exit 0
  }
}

: "ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—é–¢æ•°" && {
  ##############################################################################
  # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  ##############################################################################
  function makeBackup {
    local orgFile="${inputFile}"
    local MAX_BACKUP_COUNT=3
  
    #3ã¤ä»¥ä¸Šä½œã‚‹æ°—ãŒãªã„
    #echo 'ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ'
    if [[ -f "./$(basename ${orgFile})_bk_2" ]] ; then 
      cp -f "./$(basename ${orgFile})_bk_2" "./$(basename ${orgFile})_bk_3"
    fi
    if [[ -f "./$(basename ${orgFile})_bk_1" ]] ; then 
      cp -f "./$(basename ${orgFile})_bk_1" "./$(basename ${orgFile})_bk_2"
    fi
    cp -f "./$(basename ${orgFile})" "./$(basename ${orgFile})_bk_1"
  }
}

: "åˆæœŸå‡¦ç†" && {
  ##############################################################################
  # åˆæœŸå‡¦ç†
  ##############################################################################
  function myInit {

    #æ¨ªå¹…å–å¾—
    maxRowLength="$( tput cols )"

    #ãƒãƒ¼ãƒ‰æƒ…å ±æ¤œå‡º
    detectNode
    
    #æŒ‡å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒãƒ¼ãƒ‰æƒ…å ±ã‚’æŒã£ã¦ã„ãªã‹ã£ãŸå ´åˆã€è¿½åŠ ã™ã‚‹ã€‚
    if [[ ${maxNodeCnt} -eq 0 ]] ; then
      echo 'ãƒãƒ¼ãƒ‰ãŒã‚ã‚Šã¾ã›ã‚“ã€‚å…ˆé ­ã«ç¬¬ä¸€ãƒãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™' 
      if [ ! -s "${inputFile}" ] ; then
        echo -e "# 1st Node [,,]\n" > "${inputFile}"
      else
        sed -i "1i# 1st Node [,,]" "${inputFile}"
      fi
      read -s -n 1 c
      bash "${0}" "${inputFile}" 't'
      exit 0
    fi

    #å…¨ä½“æ–‡å­—æ•°(ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒˆãƒ«è¡Œã¨ç©ºè¡Œã‚’é™¤ã)ã®ã‚«ã‚¦ãƒ³ãƒˆ
    local allContentLines=""
    for line in "${fileLines[@]}"; do
      if [[ ! "${line}" =~ (^#.+|^//.+) ]]; then
        allContentLines+="${line}"
      fi
    done
    allCharCount="${#allContentLines}"


    #ã‚¨ãƒ‡ã‚£ã‚¿ã®è¨­å®š
    #editorListé…åˆ—ã®å„ªå…ˆé †ã§å­˜åœ¨ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã«æ±ºå®šã•ã‚Œã‚‹ã€‚
    #ãƒ¦ãƒ¼ã‚¶ã«ã‚ˆã‚‹æ›¸ãæ›ãˆã‚‚æƒ³å®š
    #(selected_editoréƒ¨åˆ†ã‚’ä»»æ„ã®ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼èµ·å‹•ã‚³ãƒãƒ³ãƒ‰ã«å¤‰æ›´)
    editorList=("${selected_editor}" 'edit' 'micro' 'nano' 'vi' 'ed')
    for itemE in "${editorList[@]}" ; do
      #ã‚³ãƒãƒ³ãƒ‰ãŒã‚¨ãƒ©ãƒ¼ã‚’è¿”ã™ã‹å¦ã‹ã§åˆ¤æ–­
      \command -v "${itemE}" >/dev/null 2>&1
      if [[ ${?} = 0 ]] ; then
        selected_editor="${itemE}"
        break
      fi
    done

    #ãƒ“ãƒ¥ãƒ¼ãƒ¯ã®è¨­å®š
    #viewerListé…åˆ—ã®å„ªå…ˆé †ã§å­˜åœ¨ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã«æ±ºå®šã•ã‚Œã‚‹ã€‚
    #ãƒ¦ãƒ¼ã‚¶ã«ã‚ˆã‚‹æ›¸ãæ›ãˆã‚‚æƒ³å®š
    #(selected_vieweréƒ¨åˆ†ã‚’ä»»æ„ã®ãƒ“ãƒ¥ãƒ¼ãƒ¯èµ·å‹•ã‚³ãƒãƒ³ãƒ‰ã«å¤‰æ›´)
    viewerList=("${selected_viewer}" 'less' 'more' 'view' 'cat')
    for itemV in "${viewerList[@]}" ; do
      #ã‚³ãƒãƒ³ãƒ‰ãŒã‚¨ãƒ©ãƒ¼ã‚’è¿”ã™ã‹å¦ã‹ã§åˆ¤æ–­
      \command -v "${itemV}" >/dev/null 2>&1
      if [[ ${?} = 0 ]] ; then
        selected_viewer="${itemV}"
        break
      fi
    done

    ################################################
    # å‹•ä½œæŒ‡å®šã®èª­ã¿æ›¿ãˆ
    ################################################

    #(å­˜åœ¨ã™ã‚‹)ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã‚’æŒ‡å®šã—ãŸå ´åˆã€ãƒ„ãƒªãƒ¼ãƒ“ãƒ¥ãƒ¼ã«èª­ã¿æ›¿ãˆ
    if [[ ${#action} = 0 ]] ; then
      echo "å‹•ä½œæŒ‡å®šãŒãªã„ãŸã‚ãƒ„ãƒªãƒ¼è¡¨ç¤ºã—ã¾ã™"
      read -s -n 1 c
      bash "${0}" "${inputFile}" 't'
      exit 0
    fi

    #å‹•ä½œæŒ‡å®šã‚’çœç•¥ã—ã¦æ®µè½ã‚’æŒ‡å®šã—ãŸå ´åˆã€ç·¨é›†ã«èª­ã¿æ›¿ãˆ
    if [[ ${action} =~ ^[0-9]+$ ]] && [[ ${#indexNo} = 0 ]] ; then
      echo "æ®µè½ã®ã¿ãŒæŒ‡å®šã•ã‚ŒãŸãŸã‚ã€ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«ã—ã¾ã™"
      read -s -n 1 c
      bash "${0}" "${inputFile}" 'e' "${action}"
      exit 0
    fi

    if [[ -f ${inputFile} ]] && [[ ${#action} = 0 ]] ; then
      bash "${0}" "${inputFile}" 't'
      exit 0
    fi

    if [[ ${action} = 'ta' ]] && [[ ${maxRowLength} -le 50 ]] ; then
      if [[ ${maxRowLength} -le 40 ]] ; then
        echo "ç”»é¢ã®æ¨ªå¹…ãŒè¶³ã‚Šãªã„ãŸã‚è¡¨ç¤ºã‚’ç¸®é€€ã—ã¾ã™"
        read -s -n 1 c
        bash "${0}" "${inputFile}" 't'
        exit 0
      else
        echo "ç”»é¢ã®æ¨ªå¹…ãŒè¶³ã‚Šãªã„ãŸã‚è¡¨ç¤ºã‚’ç¸®é€€ã—ã¾ã™"
        read -s -n 1 c
        bash "${0}" "${inputFile}" 'tl'
        exit 0
      fi
    fi
    if [[ ${action} = 'tl' ]] && [[ ${maxRowLength} -le 40 ]] ; then
      echo "ç”»é¢ã®æ¨ªå¹…ãŒè¶³ã‚Šãªã„ãŸã‚è¡¨ç¤ºã‚’ç¸®é€€ã—ã¾ã™"
      read -s -n 1 c
      bash "${0}" "${inputFile}" 't'
      exit 0
    fi

    ######################################
    #ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ
    ######################################
    makeBackupActionList=('e' 'd' 'i' 'ie' 'ml' 'mr' 'md' 'mu' 'gml' 'gmr' 'gmu' 'gmd' 'c' 's')
    if arrayContains "${action}" "${makeBackupActionList[@]}"; then
      makeBackup
    fi

  }
}

: "ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ãƒã‚§ãƒƒã‚¯" && {
  ##############################################################################
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  # æˆ»ã‚Šå€¤:0(æˆåŠŸ)/9(å¤±æ•—)
  ##############################################################################
  function parameterCheck {
    
    local depth=$(getDepth ${indexNo})

    #å‹•ä½œæŒ‡å®šã®ãƒã‚§ãƒƒã‚¯
    allowActionList=('h' 'gh' 'e' 'd' 'gd' 'i' 'ie' 't' 'th' 'tl' 'ta' 'f' 'fl' 'fa' 'v' 'gv' 'ml' 'mr' 'md' 'mu' 'gml' 'gmr' 'gmu' 'gmd' 'j' 'gj' 'k' 'gk' 'gc' 's' 'o')
    if ! arrayContains "${action}" "${allowActionList[@]}"; then
      echo 'å¼•æ•°2:ç„¡åŠ¹ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã§ã™'
      read -s -n 1 c
      return 1
    fi

    unset allowActionList
    allowActionList=('h' 'gh' 'e' 'd' 'gd' 'i' 'ie' 'f' 'fl' 'fa' 'v' 'gv' 'ml' 'mr' 'md' 'mu' 'gml' 'gmr' 'gmu' 'gmd' 'j' 'gj' 'k' 'gk' 'gc' 's' 'o')
    if arrayContains "${action}" "${allowActionList[@]}"; then
      if [[ ${indexNo} = '' ]] ; then
        echo "ãƒãƒ¼ãƒ‰ã‚’æŒ‡å®šã—ã¦ãã ã•ã„"
        read -s -n 1 c
        return 1
      fi
    fi
    if arrayContains "${action}" "${allowActionList[@]}"; then
      if [[ ${indexNo} -le 0 ]] || [[ ${indexNo} -gt ${maxNodeCnt} ]] ; then
        echo "${indexNo}ç•ªç›®ã®ãƒãƒ¼ãƒ‰ã¯å­˜åœ¨ã—ã¾ã›ã‚“"
        read -s -n 1 c
        return 1
      fi
    fi

    #å‹•ä½œæŒ‡å®šã¨ãƒãƒ¼ãƒ‰ç•ªå·ã®ãƒã‚§ãƒƒã‚¯(ãƒãƒ¼ãƒ‰çŠ¶æ…‹ã®å–å¾—ãŒå¿…è¦ãªãƒã‚§ãƒƒã‚¯ã¯å¾Œç¶šã§å®Ÿæ–½)
    unset allowActionList
    allowActionList=('ml' 'gml')
    if arrayContains "${action}" "${allowActionList[@]}" && [[ ${depth} -le 1 ]] ; then
      echo "ãƒãƒ¼ãƒ‰ç•ªå·${indexNo}ã¯ã“ã‚Œä»¥ä¸Šæµ…ã(å·¦ã«ç§»å‹•)ã§ãã¾ã›ã‚“"
      read -s -n 1 c
      return 1
    fi

    unset allowActionList
    allowActionList=('mr' 'gmr')
    if arrayContains "${action}" "${allowActionList[@]}" && [[ ${depth} -ge 10 ]] ; then
      echo "ãƒãƒ¼ãƒ‰ç•ªå·${indexNo}ã®æ·±ã•ã¯${depth}ã§ã™ã€‚ã“ã‚Œä»¥ä¸Šæ·±ã(å³ã«ç§»å‹•)ã§ãã¾ã›ã‚“"
      read -s -n 1 c
      return 1
    fi

    unset allowActionList
    allowActionList=('mu' 'gmu')
    if arrayContains "${action}" "${allowActionList[@]}" && [[ ${indexNo} -eq 1 ]] ; then
      echo 'å¼•æ•°2:1ç•ªç›®ã®ãƒãƒ¼ãƒ‰ã¯ä¸Šã«ç§»å‹•ã§ãã¾ã›ã‚“'
      read -s -n 1 c
      return 1
    fi

    unset allowActionList
    allowActionList=('md' 'gmd')
    if arrayContains "${action}" "${allowActionList[@]}" && [[ ${indexNo} -ge ${maxNodeCnt} ]] ; then
      echo "å¼•æ•°2:${indexNo}ç•ªç›®ã®ãƒãƒ¼ãƒ‰ã¯ä¸‹ã«ç§»å‹•ã§ãã¾ã›ã‚“"
      read -s -n 1 c
      return 1
    fi

    # if [[ "${action}" = 'h' ]] && [[ ! "${option}" =~ [0-1] ]] ; then
    #   echo "ä¸å¯è¦–è¨­å®šã¯0ã‹1ã§æŒ‡å®šã—ã¦ãã ã•ã„ã€‚"
    #   read -s -n 1 c
    #   return 1
    # fi

  }
}

: "ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‹ã‹ã‚‹å‡¦ç†" && {
  ##############################################################################
  # ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  # æˆ»ã‚Šå€¤:ãªã—
  ##############################################################################
  function rm_tmpfile {
    [[ -f "${tmpfileHeader}" ]] && rm -f "${tmpfileHeader}"
    [[ -f "${tmpfileSelect}" ]] && rm -f "${tmpfileSelect}"
    [[ -f "${tmpfileTarget}" ]] && rm -f "${tmpfileTarget}"
    [[ -f "${tmpfileFooter}" ]] && rm -f "${tmpfileFooter}"
  }

  ##############################################################################
  # ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
  # å¼•æ•°:ãªã—(ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ã¿)
  # æˆ»ã‚Šå€¤:ãªã—
  ##############################################################################
  function makeTmpfile {

    # ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚‹
    tmpfileHeader=$(mktemp)
    tmpfileSelect=$(mktemp)
    tmpfileTarget=$(mktemp)
    tmpfileFooter=$(mktemp)
    tmpfile1=$(mktemp)
    tmpfile2=$(mktemp)
  }
}

: "ä¸»å‡¦ç†" && {
  ##############################################################################
  # ä¸»å‡¦ç†
  # å¼•æ•°1:å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹
  # å¼•æ•°2:å‹•ä½œåŒºåˆ†
  # å¼•æ•°3:å¯¾è±¡ãƒãƒ¼ãƒ‰ç•ªå·
  # å¼•æ•°4:å‹•ä½œåŒºåˆ†ã«å¯¾ã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³æŒ‡å®š
  # æˆ»ã‚Šå€¤:ãªã—
  ##############################################################################
  function main {
    
    inputFile="${1}"
    action="${2}"
    indexNo="${3}"
    option="${4}"

    #å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
    if [[ ! -f ${inputFile} ]] ; then
      echo "${inputFile} ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã¯å­˜åœ¨ã—ã¾ã›ã‚“ã€‚"
      read -p "${inputFile} ã‚’ä½œæˆã—ã¾ã™ã‹ï¼Ÿ(y/n) :" YN
      if [ "${YN}" = "y" ]; then
        touch "${inputFile}"
        bash "${0}" "${inputFile}" 't'
        exit 0
      else
        echo "çµ‚äº†ã—ã¾ã™"
        exit 1;
      fi
    fi

    # åˆæœŸå‡¦ç†
    myInit

    #ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒã‚§ãƒƒã‚¯
    parameterCheck
    if [[ ${?} -ne 0 ]] ; then 
      exit 1
    fi

    makeTmpfile # ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ

    char1="${action:0:1}"
    char2="${action:1:1}"
    char3="${action:2:1}"

    case "${char1}" in
      'o')  outputGroup "${option}"
            ;;
      's')  clear
            setSymbol
            ;;
      'j')  clear
            joinNode
            ;;
      'k')  clear
            switchProgress
            ;;
      'h')  clear
            setHideFlag
            ;;
      't')  clear
            displayTree
            ;;
      'm')  case "${char2}" in 
              [ud]) clear
                    swapNode
                    ;;
              [lr]) clear
                    slideNode
                    ;;
              *)  echo 'err'
                  ;;
            esac
            ;;
      'g')  case "${char2}" in 
              'v')  clear
                    groupView
                    ;;
              'c')  dispGroupCharCount
                    ;;
              'k')  setProgressGroup
                    ;;
              'd')  deleteGroup
                    ;;
              'j')  joinGroup
                    ;;
              'h')  hideGroup
                    ;;
              *)  case "${char3}" in 
                    [ud]) clear
                          swapGroup
                          ;;
                    [lr]) clear
                          slideGroup
                          ;;
                    [lr]) clear
                          slideGroup
                          ;;
                    *)  echo 'err'
                        ;;
                  esac
            esac
            ;;
      'f')  clear
            focusMode
            ;;
      'i')  clear
            case "${char2}" in
              '') insertNode
                  ;;
              'e') insertEdit
                  ;;              
            esac
            ;;
      [edv])  clear
              singleNodeOperations
              ;;
      *) ;;
    esac
  }  
}

###########################################
# ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
###########################################

if [[ "${1}${2}${3}${4}" = '' ]] ; then
  echo "å¼•æ•°ãŒä¸ãˆã‚‰ã‚Œãªã‹ã£ãŸãŸã‚ãƒ˜ãƒ«ãƒ—è¡¨ç¤ºã—ã¾ã™"
  read -s -n 1 c
  displayHelp
  read -s -n 1 c
  exit 0
fi
if [[ "${1}" = 'h' ]] || [[ "${1}" = '-h' ]] || [[ "${1}" = '--help' ]] || [[ "${1}" = '/h' ]]; then
  displayHelp "${2}"
  read -s -n 1 c
  exit 0
fi

main "${1}" "${2}" "${3}" "${4}"

# æ­£å¸¸çµ‚äº†ã—ãŸã¨ãã«ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã™ã‚‹
trap rm_tmpfile EXIT
# ç•°å¸¸çµ‚äº†ã—ãŸã¨ãã«ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã™ã‚‹
trap 'trap - EXIT; rm_tmpfile; exit -1' INT PIPE TERM
